library(gdata)#
library(MASS)#
library(DAAG)#
library(RColorBrewer)#
library(FactoMineR)#
library(heatmap.plus)#
library(ggplot2)#
library(DMwR)#
library(reshape)#
read.rain <- function(x)#
{#
	filnamelistlength <- length(x)#
	mir <- read.delim(x[1], header = TRUE, sep = "\t")#
	mir$filename <- factor(x[1])#
#
	rain <- mir#
	print(nrow(rain))#
	for (i in 2:filnamelistlength)#
	{#
	mir <- read.delim(x[i], header = TRUE, sep = "\t")#
	mir$filename <- factor(x[i])#
	rain <- rbind(rain,mir)#
	print(nrow(rain))#
	}	#
	return (rain)#
}#
filenames = c("PP1_a.txt","PP1_b.txt","PP2_a.txt","PP2_b.txt")#
rain <- read.rain(filenames)#
#
summary(rain)#
table(rain$filename)#
rainall <- rain#
write.table(rainall,file = "CompleteDataSet.txt", sep = "\t")#
head(rain)#
colnames(rain)#
colnames(rain) <- c("Row","Col","Well","Primer","Sample" , "CT","Tm1","Tm2","Notes","x","x1","Filename")#
rain <-rain[,c("Row","Col","Well","Primer","Sample" , "CT","Tm1","Tm2","Filename")] #
summary(rain)#
rain$Col	<- factor(rain$Col)#
#
levels(rain$Filename)#
levels(rain$Filename) <- list(PP1 = c("PP1_a.txt","PP1_b.txt"), PP2 = c("PP2_a.txt","PP2_b.txt"))#
#
rain$Primer2 <- interaction(rain$Filename, rain$Primer)#
table(rain$Primer)#
#
rain[is.na(rain$CT),] #
rain[is.na(rain$CT),"CT"] <- 40#
#
rain[is.na(rain$Tm1),"Tm1"] <- 99#
rain[is.na(rain$Tm2),"Tm2"] <- 99#
#
rain[is.na(rain$Primer),]#
rain[is.na(rain$Sample),]#
rain <- na.omit(rain)#
rain <- drop.levels(rain)#
#
summary(rain)#
head(rain)#
table(rain$Primer2)#
rainCluster	<- rain[,c("Primer2","Sample","CT")]
rainCluster <- cast(rainCluster, Primer3 ~ Sample, mean)
mad.na <- function(x)#
{#
	mad(x, na.rm = TRUE)#
}#
par(mfrow = c(1,2))#
par(cex=1.4)#
plot(ecdf(apply(rainCluster[,2:ncol(rainCluster)],1, mad.na)), main = nrow(rainCluster), col = "darkred", cex = 0.5, xlab = "m.a.d in CT units")#
rainCluster <- subset(rainCluster, apply(rainCluster[,3:ncol(rainCluster)],1, mad.na) > 1)#
plot(ecdf(apply(rainCluster[,2:ncol(rainCluster)],1, mad.na)), main = nrow(rainCluster), col = "darkblue", cex = 0.5, xlab = "m.a.d in CT units")#
nrow(rainCluster)
par(mfrow = c(1,2))#
par(cex=1.4)#
plot(ecdf(apply(rainCluster[,2:ncol(rainCluster)],1, mad.na)), main = nrow(rainCluster), col = "darkred", cex = 0.5, xlab = "m.a.d in CT units")#
rainCluster <- subset(rainCluster, apply(rainCluster[,3:ncol(rainCluster)],1, mad.na) > 1)#
plot(ecdf(apply(rainCluster[,2:ncol(rainCluster)],1, mad.na)), main = nrow(rainCluster), col = "darkblue", cex = 0.5, xlab = "m.a.d in CT units")#
nrow(rainCluster)
rainCluster <- cast(rainCluster, Primer2 ~ Sample, mean)#
summary(rainCluster)
mad.na <- function(x)#
{#
	mad(x, na.rm = TRUE)#
}
plot(ecdf(apply(rainCluster[,2:ncol(rainCluster)],1, mad.na)), main = nrow(rainCluster), col = "darkblue", cex = 0.5, xlab = "m.a.d in CT units")#
nrow(rainCluster)
rainCluster
rainCluster <- cast(rainCluster, Primer2 ~ Sample, mean)#
summary(rainCluster)#
nrow(rainCluster)#
head(rainCluster)#
colnames(rainCluster)#
mad.na <- function(x)#
{#
	mad(x, na.rm = TRUE)#
}
rainCluster <- subset(rainCluster, apply(rainCluster[,3:ncol(rainCluster)],1, mad.na) > 0)
apply(rainCluster[,2:ncol(rainCluster)],1, mad.na)
rainCluster	<- rain[,c("Primer2","Sample","CT")]#
png(file = "Input.png", units = "in", width = 5, height = 20, res = 600)#
#
a <- qplot(Sample, Primer2, col = cut(CT,4), data = rain, size = I(2), alpha = I(1/2), geom= c("point"))#
a <- a + opts(strip.background = theme_rect(colour = "white")) + opts(legend.position = "right") #
a <- a + opts(axis.text.x = theme_text(size = 8, angle = 90)) + opts(axis.text.y = theme_text(size = 8, angle = 0)) + opts(axis.title.y = theme_text(size = 14, angle = 90)) + opts(plot.title = theme_text(size = 18)) + opts(axis.title.x = theme_text(size = 14)) + opts(strip.text.x = theme_text(size = 14))#
a <- a + opts(panel.grid.minor = theme_blank())+ opts(panel.grid.major = theme_blank())#
a#
#
dev.off()#
rainCluster <- cast(rainCluster, Primer2 ~ Sample, mean)#
summary(rainCluster)#
nrow(rainCluster)#
head(rainCluster)#
colnames(rainCluster)#
mad.na <- function(x)#
{#
	mad(x, na.rm = TRUE)#
}#
par(mfrow = c(1,2))#
par(cex=1.4)#
plot(ecdf(apply(rainCluster[,2:ncol(rainCluster)],1, mad.na)), main = nrow(rainCluster), col = "darkred", cex = 0.5, xlab = "m.a.d in CT units")#
#
rainCluster <- subset(rainCluster, apply(rainCluster[,2:ncol(rainCluster)],1, mad.na) > 0)#
#
plot(ecdf(apply(rainCluster[,2:ncol(rainCluster)],1, mad.na)), main = nrow(rainCluster), col = "darkblue", cex = 0.5, xlab = "m.a.d in CT units")#
nrow(rainCluster)
rgb.palette <- colorRampPalette(c("white", "orange", "red"), space = "rgb", bias = 2)
rgb.palette <- colorRampPalette(c("red", "yellow", "white"), space = "rgb", bias = 2)
rgb.palette <- colorRampPalette(c("red", "orange", "white"), space = "rgb", bias = 2)#
heatmap.plus(try2m, na.rm = T, scale = "none", col = rgb.palette(25), hclustfun=function(m) hclust(m, method="single"), distfun = function(x) dist(x, method = "manhattan"), margins = c(10,10), Colv = T, Rowv = T)
heatmap.plus(try2m, na.rm = T, scale = "none", col = rgb.palette(5), hclustfun=function(m) hclust(m, method="single"), distfun = function(x) dist(x, method = "manhattan"), margins = c(10,10), Colv = T, Rowv = T)
heatmap.plus(try2m, na.rm = T, scale = "none", col = rgb.palette(10), hclustfun=function(m) hclust(m, method="single"), distfun = function(x) dist(x, method = "manhattan"), margins = c(10,10), Colv = T, Rowv = T)
rainCluster	<- rain[,c("Primer2","Sample","CT")]#
png(file = "Input.png", units = "in", width = 5, height = 20, res = 600)#
#
a <- qplot(Sample, Primer2, col = cut(CT,4), data = rain, size = I(2), alpha = I(1/2), geom= c("point"))#
a <- a + opts(strip.background = theme_rect(colour = "white")) + opts(legend.position = "right") #
a <- a + opts(axis.text.x = theme_text(size = 8, angle = 90)) + opts(axis.text.y = theme_text(size = 8, angle = 0)) + opts(axis.title.y = theme_text(size = 14, angle = 90)) + opts(plot.title = theme_text(size = 18)) + opts(axis.title.x = theme_text(size = 14)) + opts(strip.text.x = theme_text(size = 14))#
a <- a + opts(panel.grid.minor = theme_blank())+ opts(panel.grid.major = theme_blank())#
a#
#
dev.off()#
rainCluster <- cast(rainCluster, Primer2 ~ Sample, mean)#
summary(rainCluster)#
nrow(rainCluster)#
head(rainCluster)#
colnames(rainCluster)#
mad.na <- function(x)#
{#
	mad(x, na.rm = TRUE)#
}#
par(mfrow = c(1,2))#
par(cex=1.4)#
plot(ecdf(apply(rainCluster[,2:ncol(rainCluster)],1, mad.na)), main = nrow(rainCluster), col = "darkred", cex = 0.5, xlab = "m.a.d in CT units")#
#
rainCluster.mad <- subset(rainCluster, apply(rainCluster[,2:ncol(rainCluster)],1, mad.na) > 0)#
#
plot(ecdf(apply(rainCluster.mad[,2:ncol(rainCluster)],1, mad.na)), main = nrow(rainCluster), col = "darkblue", cex = 0.5, xlab = "m.a.d in CT units")#
nrow(rainCluster)#
try2m <- as.matrix(rainCluster[,2:ncol(rainCluster)])#
nrow(try2m)#
nrow(try2m[!complete.cases(try2m),])#
rownames(try2m) <- rainCluster[,1]#
colnames(try2m) <- colnames(rainCluster[,2:ncol(rainCluster)])#
head(try2m)
rgb.palette <- colorRampPalette(c("red", "orange", "white"), space = "rgb", bias = 2)#
heatmap.plus(try2m, na.rm = T, scale = "none", col = rgb.palette(10), hclustfun=function(m) hclust(m, method="single"), distfun = function(x) dist(x, method = "manhattan"), margins = c(10,10), Colv = T, Rowv = T)
heatmap.plus(try2m, na.rm = T, scale = "none", col = rgb.palette(25), hclustfun=function(m) hclust(m, method="single"), distfun = function(x) dist(x, method = "manhattan"), margins = c(10,10), Colv = T, Rowv = T)
heatmap.plus(try2m, na.rm = T, scale = "none", col = rgb.palette(25), hclustfun=function(m) hclust(m, method="average"), distfun = function(x) dist(x, method = "manhattan"), margins = c(10,10), Colv = T, Rowv = T)
png(file = "heatmap.png", units = "in", width = 20, height = 4, res = 600)#
rgb.palette <- colorRampPalette(c("red", "orange", "white"), space = "rgb", bias = 2)#
heatmap.plus(try2m, na.rm = T, scale = "none", col = rgb.palette(20), hclustfun=function(m) hclust(m, method="average"), distfun = function(x) dist(x, method = "manhattan"), margins = c(10,10), Colv = T, Rowv = T)#
#
dev.off()
png(file = "heatmap.png", units = "in", width = 4, height = 20, res = 600)#
rgb.palette <- colorRampPalette(c("red", "orange", "white"), space = "rgb", bias = 2)#
heatmap.plus(try2m, na.rm = T, scale = "none", col = rgb.palette(20), hclustfun=function(m) hclust(m, method="average"), distfun = function(x) dist(x, method = "manhattan"), margins = c(10,10), Colv = T, Rowv = T)#
#
dev.off()
filenames = c("PP1_a.txt","PP1_b.txt","PP2_a.txt","PP2_b.txt")#
rain <- read.rain(filenames)#
summary(rain)#
table(rain$filename)#
rainall <- rain#
write.table(rainall,file = "CompleteDataSet.txt", sep = "\t")#
head(rain)#
colnames(rain)#
colnames(rain) <- c("Row","Col","Well","Primer","Sample" , "CT","Tm1","Tm2","Notes","x","x1","Filename")#
rain <-rain[,c("Row","Col","Well","Primer","Sample" , "CT","Tm1","Tm2","Filename")] #
summary(rain)#
rain$Col	<- factor(rain$Col)#
#
levels(rain$Filename)#
levels(rain$Filename) <- list(PP1 = c("PP1_a.txt","PP1_b.txt"), PP2 = c("PP2_a.txt","PP2_b.txt"))#
#
rain$Primer2 <- interaction(rain$Filename, rain$Primer)#
table(rain$Primer)#
#
rain[is.na(rain$CT),] #
rain[is.na(rain$CT),"CT"] <- 40#
#
rain[is.na(rain$Tm1),"Tm1"] <- 99#
rain[is.na(rain$Tm2),"Tm2"] <- 99#
#
rain[is.na(rain$Primer),]#
rain[is.na(rain$Sample),]#
rain <- na.omit(rain)#
rain <- drop.levels(rain)#
#
summary(rain)#
head(rain)#
table(rain$Primer2)#
rainCluster	<- rain[,c("Primer2","Sample","CT")]#
png(file = "Input.png", units = "in", width = 5, height = 20, res = 600)#
{#
a <- qplot(Sample, Primer2, col = cut(CT,4), data = rain, size = I(2), alpha = I(1/2), geom= c("point"))#
a <- a + opts(strip.background = theme_rect(colour = "white")) + opts(legend.position = "right") #
a <- a + opts(axis.text.x = theme_text(size = 8, angle = 90)) + opts(axis.text.y = theme_text(size = 8, angle = 0)) + opts(axis.title.y = theme_text(size = 14, angle = 90)) + opts(plot.title = theme_text(size = 18)) + opts(axis.title.x = theme_text(size = 14)) + opts(strip.text.x = theme_text(size = 14))#
a <- a + opts(panel.grid.minor = theme_blank())+ opts(panel.grid.major = theme_blank())#
a#
}#
dev.off()
source("/Volumes/BigRAID/trials/trialAMC059_PTC299/arrayData_DreamArrayValidation/amc059qpcr.R")
library(gdata)
library(MASS)
library(DAAG)
library(RColorBrewer)
library(FactoMineR)
library(heatmap.plus)
library(ggplot2)
library(DMwR)
library(reshape2)
read.rain <- function(x)#
{#
	filnamelistlength <- length(x)#
	mir <- read.delim(x[1], header = TRUE, sep = "\t")#
	mir$filename <- factor(x[1])#
#
	rain <- mir#
	print(nrow(rain))#
	for (i in 2:filnamelistlength)#
	{#
	mir <- read.delim(x[i], header = TRUE, sep = "\t")#
	mir$filename <- factor(x[i])#
	rain <- rbind(rain,mir)#
	print(nrow(rain))#
	}	#
	return (rain)#
}#
filenames = c("PP1_a.txt","PP1_b.txt","PP2_a.txt","PP2_b.txt")#
rain <- read.rain(filenames)#
summary(rain)#
table(rain$filename)#
rainall <- rain#
write.table(rainall,file = "CompleteDataSet.txt", sep = "\t")
head(rain)#
colnames(rain)#
colnames(rain) <- c("Row","Col","Well","Primer","Sample" , "CT","Tm1","Tm2","Notes","x","x1","Filename")#
rain <-rain[,c("Row","Col","Well","Primer","Sample" , "CT","Tm1","Tm2","Filename")] #
summary(rain)
rain$Col	<- factor(rain$Col)
levels(rain$Filename)
levels(rain$Filename) <- list(PP1 = c("PP1_a.txt","PP1_b.txt"), PP2 = c("PP2_a.txt","PP2_b.txt"))
rain$Primer2 <- interaction(rain$Filename, rain$Primer)
table(rain$Primer)
rain[is.na(rain$CT),]
rain[is.na(rain$CT),"CT"] <- 40
rain[is.na(rain$Tm1),"Tm1"] <- 99.999
rain[is.na(rain$Tm2),"Tm2"] <- 99.999
rain[rain$CT>39.9,"Tm2"] <- 99.999
rain[rain$CT>39.9,"Tm1"] <- 99.999
rain[rain$Tm1<1,"Tm1"] <- 99.999
rain[rain$Tm2<1,"Tm2"] <- 99.999
temp.Tm1 <- rain[rain$Tm2 < rain$Tm1, "Tm1"]
rain[rain$Tm2 < rain$Tm1, "Tm1"] <- rain$Tm2
rain[rain$Tm2 < rain$Tm1, "Tm2"] <- temp.Tm1
rain[is.na(rain$Primer),]
rain[is.na(rain$Sample),]
rain <- na.omit(rain)
rain <- drop.levels(rain)
head(rain)
table(rain$Primer2)
a <- qplot(Sample, Primer2, col = cut(CT,4), data = rain, size = I(2), alpha = I(1/2), geom= c("point"))#
a <- a + opts(strip.background = theme_rect(colour = "white")) + opts(legend.position = "right") #
a <- a + opts(axis.text.x = theme_text(size = 8, angle = 90)) + opts(axis.text.y = theme_text(size = 8, angle = 0)) + opts(axis.title.y = theme_text(size = 14, angle = 90)) + opts(plot.title = theme_text(size = 18)) + opts(axis.title.x = theme_text(size = 14)) + opts(strip.text.x = theme_text(size = 14))#
a <- a + opts(panel.grid.minor = theme_blank())+ opts(panel.grid.major = theme_blank())#
a
rainCluster <- cast(rainCluster, Primer2 ~ Sample, mean)
rainCluster <- dcast(rainCluster, Primer2 ~ Sample, mean)
summary(rainCluster)
nrow(rainCluster)
head(rainCluster)
colnames(rainCluster)
mad.na <- function(x)#
{#
mad(x, na.rm = TRUE)#
}
par(mfrow = c(1,2))#
par(cex=1.4)#
plot(ecdf(apply(rainCluster[,2:ncol(rainCluster)],1, mad.na)), main = nrow(rainCluster), col = "darkred", cex = 0.5, xlab = "m.a.d in CT units")
rainCluster.mad <- subset(rainCluster, apply(rainCluster[,2:ncol(rainCluster)],1, mad.na) > 0)
plot(ecdf(apply(rainCluster.mad[,2:ncol(rainCluster)],1, mad.na)), main = nrow(rainCluster.mad), col = "darkblue", cex = 0.5, xlab = "m.a.d in CT units")#
nrow(rainCluster)
try2m <- as.matrix(rainCluster[,2:ncol(rainCluster)])#
nrow(try2m)#
nrow(try2m[!complete.cases(try2m),])#
rownames(try2m) <- rainCluster[,1]#
colnames(try2m) <- colnames(rainCluster[,2:ncol(rainCluster)])#
head(try2m)
png(file = "heatmap.png", units = "in", width = 4, height = 20, res = 600)#
rgb.palette <- colorRampPalette(c("red", "orange", "white"), space = "rgb", bias = 2)
heatmap.plus(try2m, na.rm = T, scale = "none", col = rgb.palette(20), hclustfun=function(m) hclust(m, method="average"), distfun = function(x) dist(x, method = "manhattan"), margins = c(10,10), Colv = T, Rowv = T)#
#
dev.off()
heatmap.plus(try2m, na.rm = T, scale = "none", col = rgb.palette(20), hclustfun=function(m) hclust(m, method="average"), distfun = function(x) dist(x, method = "manhattan"), margins = c(10,10), Colv = T, Rowv = T)
heatmap.plus(try2m, na.rm = T, scale = "none", col = rgb.palette(20), hclustfun=function(m) hclust(m, method="average"), distfun = function(x) dist(x, method = "manhattan"), margins = c(10,10), Colv = NA, Rowv = T)
png(file = "heatmap.png", units = "in", width = 4, height = 20, res = 600)#
rgb.palette <- colorRampPalette(c("red", "orange", "white"), space = "rgb", bias = 2)#
heatmap.plus(try2m, na.rm = T, scale = "none", col = rgb.palette(20), hclustfun=function(m) hclust(m, method="average"), distfun = function(x) dist(x, method = "manhattan"), margins = c(10,10), Colv = NA, Rowv = T)#
#
dev.off()
png(file = "heatmap.png", units = "in", width = 4, height = 20, res = 300)#
{#
rgb.palette <- colorRampPalette(c("red", "orange", "white"), space = "rgb", bias = 2)#
heatmap.plus(try2m, na.rm = T, scale = "none", col = rgb.palette(20), hclustfun=function(m) hclust(m, method="average"), distfun = function(x) dist(x, method = "manhattan"), margins = c(10,10), Colv = NA, Rowv = T)#
}#
dev.off()
brewer.palette <- colorRampPalette(rev(brewer.pal(11, "RdYlBu")),space = "rgb", bias = .7, interpolate = "linear")#
heatmap.plus(try2m, na.rm = T, scale = "row", col = brewer.palette (25),#
hclustfun=function(m) hclust(m, method="ward"), #
distfun = function(x) dist(x, method = "manhattan"), #
margins = c(12,24), #
Colv = T, Rowv = T, #
cexRow = 1, cexCol = 0.5,#
main = "dCT' centered by primer", xlab = "primer", ylab = "samples")
brewer.palette <- colorRampPalette(rev(brewer.pal(11, "RdYlBu")),space = "rgb", bias = .7, interpolate = "linear")#
heatmap.plus(try2m, na.rm = T, scale = "row", col = brewer.palette (55),#
hclustfun=function(m) hclust(m, method="ward"), #
distfun = function(x) dist(x, method = "manhattan"), #
margins = c(12,24), #
Colv = T, Rowv = T, #
cexRow = 1, cexCol = 1,#
main = "dCT' centered by primer", xlab = "primer", ylab = "samples")
brewer.palette <- colorRampPalette(rev(brewer.pal(11, "RdYlBu")),space = "rgb", bias = .7, interpolate = "linear")#
heatmap.plus(try2m, na.rm = T, scale = "row", col = brewer.palette (55),#
hclustfun=function(m) hclust(m, method="ward"), #
distfun = function(x) dist(x, method = "manhattan"), #
margins = c(12,24), #
Colv = NA, Rowv = T, #
cexRow = 1, cexCol = 1,#
main = "", xlab = "sample", ylab = "Primer")
head(try2m[,1:4])
head(try2m[,-4])
heatmap.plus(try2m, na.rm = T, scale = "row", col = brewer.palette (55),#
hclustfun=function(m) hclust(m, method="ward"), #
distfun = function(x) dist(x, method = "manhattan"), #
margins = c(12,24), #
Colv = NA, Rowv = T, #
cexRow = 1, cexCol = 1,#
main = "", xlab = "sample", ylab = "Primer")
brewer.palette <- colorRampPalette(brewer.pal(11, "RdYlBu"),space = "rgb", bias = .7, interpolate = "linear")#
heatmap.plus(try2m, na.rm = T, scale = "row", col = brewer.palette (55),#
hclustfun=function(m) hclust(m, method="ward"), #
distfun = function(x) dist(x, method = "manhattan"), #
margins = c(12,24), #
Colv = T, Rowv = T, #
cexRow = 1, cexCol = 1,#
main = "", xlab = "sample", ylab = "Primer")
brewer.palette <- colorRampPalette(brewer.pal(11, "RdYlBu"),space = "rgb", bias = .7, interpolate = "linear")#
heatmap.plus(try2m, na.rm = T, scale = "row", col = brewer.palette (55),#
hclustfun=function(m) hclust(m, method="ward"), #
distfun = function(x) dist(x, method = "manhattan"), #
margins = c(12,24), #
Colv = T, Rowv = NA, #
cexRow = 1, cexCol = 1,#
main = "", xlab = "sample", ylab = "Primer")
brewer.palette <- colorRampPalette(brewer.pal(11, "RdYlBu"),space = "rgb", bias = .7, interpolate = "linear")#
heatmap.plus(try2m, na.rm = T, scale = "row", col = brewer.palette (55),#
hclustfun=function(m) hclust(m, method="ward"), #
distfun = function(x) dist(x, method = "manhattan"), #
margins = c(12,24), #
Colv = NA, Rowv = NA, #
cexRow = 1, cexCol = 1,#
main = "", xlab = "sample", ylab = "Primer")
try2m.m <- rbind(try2m.m, try2m[,-4])
head(try2.m)
try2m.m <- rbind(try2m.m, as.data.frame(try2m[,-4])
)
try2m.m <- try2m[,4]
try2m.m <- as.data.frame(try2m[,4])
head(try2m.m)
try2m.m <- as.data.frame(try2m.m, try2m[,-4])
try2m <- as.data.frame(try2.m)
try2m.m <- as.data.frame(try2m[,4], try2m[,-4])
try2m.m <- as.data.frame(try2m[,4], try2m[,2])
rainCluster	<- rain[,c("Primer2","Sample","CT")]
rainCluster <- dcast(rainCluster, Primer2 ~ Sample, mean)#
summary(rainCluster)#
nrow(rainCluster)#
head(rainCluster)#
colnames(rainCluster)
mad.na <- function(x)#
{#
mad(x, na.rm = TRUE)#
}#
png(file = "mad.png", units = "in", width = 5, height = 5, res = 600)#
{#
par(mfrow = c(1,2))#
par(cex=1.4)#
plot(ecdf(apply(rainCluster[,2:ncol(rainCluster)],1, mad.na)), main = nrow(rainCluster), col = "darkred", cex = 0.5, xlab = "m.a.d in CT units")#
#
rainCluster.mad <- subset(rainCluster, apply(rainCluster[,2:ncol(rainCluster)],1, mad.na) > 0)#
#
plot(ecdf(apply(rainCluster.mad[,2:ncol(rainCluster)],1, mad.na)), main = nrow(rainCluster.mad), col = "darkblue", cex = 0.5, xlab = "m.a.d in CT units")#
nrow(rainCluster)#
}#
dev.off()#
try2m <- as.matrix(rainCluster[,2:ncol(rainCluster)])#
nrow(try2m)#
nrow(try2m[!complete.cases(try2m),])#
rownames(try2m) <- rainCluster[,1]#
colnames(try2m) <- colnames(rainCluster[,2:ncol(rainCluster)])#
head(try2m)
filenames = c("PP1_a.txt","PP1_b.txt","PP2_a.txt","PP2_b.txt")#
rain <- read.rain(filenames)#
summary(rain)#
table(rain$filename)#
rainall <- rain#
write.table(rainall,file = "CompleteDataSet.txt", sep = "\t")#
head(rain)#
colnames(rain)#
colnames(rain) <- c("Row","Col","Well","Primer","Sample" , "CT","Tm1","Tm2","Notes","x","x1","Filename")#
rain <-rain[,c("Row","Col","Well","Primer","Sample" , "CT","Tm1","Tm2","Filename")] #
summary(rain)#
rain$Col	<- factor(rain$Col)#
#
levels(rain$Filename)#
levels(rain$Filename) <- list(PP1 = c("PP1_a.txt","PP1_b.txt"), PP2 = c("PP2_a.txt","PP2_b.txt"))#
#
rain$Primer2 <- interaction(rain$Filename, rain$Primer)#
table(rain$Primer)#
#
rain[is.na(rain$CT),] #
rain[is.na(rain$CT),"CT"] <- 40#
rain[is.na(rain$Tm1),"Tm1"] <- 99.999#
rain[is.na(rain$Tm2),"Tm2"] <- 99.999#
#
rain[rain$CT>39.9,"Tm1"] <- 99.999#
rain[rain$CT>39.9,"Tm2"] <- 99.999#
#
rain[rain$Tm1<1,"Tm1"] <- 99.999#
rain[rain$Tm2<1,"Tm2"] <- 99.999#
#
temp.Tm1 <- rain[rain$Tm2 < rain$Tm1, "Tm1"]#
rain[rain$Tm2 < rain$Tm1, "Tm1"] <- rain$Tm2#
rain[rain$Tm2 < rain$Tm1, "Tm2"] <- temp.Tm1 #
rain[is.na(rain$Primer),]#
rain[is.na(rain$Sample),]#
rain <- na.omit(rain)#
rain <- drop.levels(rain)#
summary(rain)#
head(rain)#
table(rain$Primer2)
rainCluster	<- rain[,c("Primer2","Sample","CT")]#
png(file = "Input.png", units = "in", width = 5, height = 20, res = 600)#
{#
a <- qplot(Sample, Primer2, col = cut(CT,4), data = rain, size = I(2), alpha = I(1/2), geom= c("point"))#
a <- a + opts(strip.background = theme_rect(colour = "white")) + opts(legend.position = "right") #
a <- a + opts(axis.text.x = theme_text(size = 8, angle = 90)) + opts(axis.text.y = theme_text(size = 8, angle = 0)) + opts(axis.title.y = theme_text(size = 14, angle = 90)) + opts(plot.title = theme_text(size = 18)) + opts(axis.title.x = theme_text(size = 14)) + opts(strip.text.x = theme_text(size = 14))#
a <- a + opts(panel.grid.minor = theme_blank())+ opts(panel.grid.major = theme_blank())#
a#
}#
dev.off()#
rainCluster <- dcast(rainCluster, Primer2 ~ Sample, mean)#
summary(rainCluster)#
nrow(rainCluster)#
head(rainCluster)#
colnames(rainCluster)#
mad.na <- function(x)#
{#
mad(x, na.rm = TRUE)#
}#
png(file = "mad.png", units = "in", width = 5, height = 5, res = 600)#
{#
par(mfrow = c(1,2))#
par(cex=1.4)#
plot(ecdf(apply(rainCluster[,2:ncol(rainCluster)],1, mad.na)), main = nrow(rainCluster), col = "darkred", cex = 0.5, xlab = "m.a.d in CT units")#
#
rainCluster.mad <- subset(rainCluster, apply(rainCluster[,2:ncol(rainCluster)],1, mad.na) > 0)#
#
plot(ecdf(apply(rainCluster.mad[,2:ncol(rainCluster)],1, mad.na)), main = nrow(rainCluster.mad), col = "darkblue", cex = 0.5, xlab = "m.a.d in CT units")#
nrow(rainCluster)#
}#
dev.off()#
try2m <- as.matrix(rainCluster[,2:ncol(rainCluster)])#
nrow(try2m)#
nrow(try2m[!complete.cases(try2m),])#
rownames(try2m) <- rainCluster[,1]#
colnames(try2m) <- colnames(rainCluster[,2:ncol(rainCluster)])#
head(try2m)
-----------------------------------------------------------------------------------------------------#
png(file = "heatmap.png", units = "in", width = 4, height = 20, res = 300)#
{#
rgb.palette <- colorRampPalette(c("red", "orange", "white"), space = "rgb", bias = 2)#
heatmap.plus(try2m, #
na.rm = T, scale = "none", #
col = rgb.palette(20), #
hclustfun=function(m) hclust(m, method="average"), #
distfun = function(x) dist(x, method = "manhattan"), #
margins = c(10,10), Colv = NA, Rowv = T)#
}#
dev.off()#
head(try2m)
rgb.palette <- colorRampPalette(c("red", "orange", "white"), space = "rgb", bias = 2)#
heatmap.plus(try2m, #
na.rm = T, scale = "none", #
col = rgb.palette(20), #
hclustfun=function(m) hclust(m, method="average"), #
distfun = function(x) dist(x, method = "manhattan"), #
margins = c(10,10), Colv = NA, Rowv = T)
brewer.palette <- colorRampPalette(brewer.pal(11, "RdYlBu"),space = "rgb", bias = .7, interpolate = "linear")#
heatmap.plus(try2m, na.rm = T, scale = "row", col = brewer.palette (55),#
hclustfun=function(m) hclust(m, method="ward"), #
distfun = function(x) dist(x, method = "manhattan"), #
margins = c(12,24), #
Colv = NA, Rowv = T, #
cexRow = 1, cexCol = 1,#
main = "", xlab = "sample", ylab = "Primer")
brewer.palette <- colorRampPalette(brewer.pal(11, "RdYlBu"),space = "rgb", bias = 1, interpolate = "linear")#
heatmap.plus(try2m, na.rm = T, scale = "row", col = brewer.palette (55),#
hclustfun=function(m) hclust(m, method="ward"), #
distfun = function(x) dist(x, method = "manhattan"), #
margins = c(12,24), #
Colv = NA, Rowv = T, #
cexRow = 1, cexCol = 1,#
main = "", xlab = "sample", ylab = "Primer")
brewer.palette <- colorRampPalette(brewer.pal(11, "RdYlBu"),space = "rgb", bias = 1, interpolate = "linear")#
heatmap.plus(try2m, na.rm = T, scale = "row", col = brewer.palette (55),#
hclustfun=function(m) hclust(m, method="ward"), #
distfun = function(x) dist(x, method = "manhattan"), #
margins = c(12,24), #
Colv = NA, Rowv = T, #
cexRow = 0.8, cexCol = 1,#
main = "", xlab = "sample", ylab = "Primer")
png(file = "Figure_heatmap centeredPrimer.png", units = "in", width = 4, height = 20, res = 300)#
{#
brewer.palette <- colorRampPalette(brewer.pal(11, "RdYlBu"),space = "rgb", bias = 1, interpolate = "linear")#
heatmap.plus(try2m, na.rm = T, scale = "row", col = brewer.palette (55),#
hclustfun=function(m) hclust(m, method="ward"), #
distfun = function(x) dist(x, method = "manhattan"), #
margins = c(12,24), #
Colv = NA, Rowv = T, #
cexRow = 0.8, cexCol = 1,#
main = "", xlab = "sample", ylab = "Primer")#
}#
dev.off()
png(file = "Figure_heatmap centeredPrimer.png", units = "in", width = 4, height = 20, res = 300)#
{#
brewer.palette <- colorRampPalette(brewer.pal(11, "RdYlBu"),space = "rgb", bias = 1, interpolate = "linear")#
heatmap.plus(try2m, na.rm = T, scale = "row", col = brewer.palette (55),#
hclustfun=function(m) hclust(m, method="ward"), #
distfun = function(x) dist(x, method = "manhattan"), #
margins = c(10,10), #
Colv = NA, Rowv = T, #
cexRow = 0.8, cexCol = 1,#
main = "", xlab = "sample", ylab = "Primer")#
}#
dev.off()
png(file = "Figure_heatmap centeredPrimer.png", units = "in", width = 4, height = 20, res = 300)#
{#
brewer.palette <- colorRampPalette(brewer.pal(11, "RdYlBu"),space = "rgb", bias = 1, interpolate = "linear")#
heatmap.plus(try2m, na.rm = T, scale = "row", col = brewer.palette (55),#
hclustfun=function(m) hclust(m, method="ward"), #
distfun = function(x) dist(x, method = "manhattan"), #
margins = c(10,10), #
Colv = NA, Rowv = T, #
cexRow = 0.7, cexCol = 2,#
main = "", xlab = "sample", ylab = "Primer")#
}#
dev.off()
png(file = "Figure_heatmap centeredPrimer.png", units = "in", width = 4, height = 20, res = 300)#
{#
brewer.palette <- colorRampPalette(brewer.pal(11, "RdYlBu"),space = "rgb", bias = 1, interpolate = "linear")#
heatmap.plus(try2m, na.rm = T, scale = "row", col = brewer.palette (55),#
hclustfun=function(m) hclust(m, method="ward"), #
distfun = function(x) dist(x, method = "manhattan"), #
margins = c(10,10), #
Colv = NA, Rowv = T, #
cexRow = 0.7, cexCol = 1.4,#
main = "", xlab = "sample", ylab = "Primer")#
}#
dev.off()
png(file = "Figure_ALL_heatmap centeredPrimer.png", units = "in", width = 4, height = 20, res = 300)#
{#
brewer.palette <- colorRampPalette(brewer.pal(11, "RdYlBu"),space = "rgb", bias = 1, interpolate = "linear")#
heatmap.plus(try2m, na.rm = T, scale = "row", col = brewer.palette (55),#
hclustfun=function(m) hclust(m, method="ward"), #
distfun = function(x) dist(x, method = "manhattan"), #
margins = c(10,10), #
Colv = NA, Rowv = T, #
cexRow = 0.7, cexCol = 1.4,#
main = "", xlab = "sample", ylab = "Primer")#
}#
dev.off()
try2m <- as.data.frame(try2m)
try2m$primer <- rownames(try2m)
par(mfrow = c(1,2))#
par(cex=1.4)#
plot(ecdf(apply(rain[,1:4],1, mad.na)), main = nrow(rainCluster), col = "darkred", cex = 0.5, xlab = "m.a.d in CT units")
plot(ecdf(apply(try2m[,1:4],1, mad.na)), main = nrow(rainCluster), col = "darkred", cex = 0.5, xlab = "m.a.d in CT units")
par(mfrow = c(1,2))#
par(cex=1.4)#
plot(ecdf(apply(try2m[,1:4],1, mad.na)), main = nrow(rainCluster), col = "darkred", cex = 0.5, xlab = "m.a.d in CT units")
try2m.good <- subset(try2m, apply(try2m[,1:4],1, mad.na) > 0)
plot(ecdf(apply(try2m.good[,1:4],1, mad.na)), main = nrow(rainCluster.mad), col = "darkblue", cex = 0.5, xlab = "m.a.d in CT units")
nrow(try2m)
nrow(try2m.good)
try2m.good <- subset(try2m, apply(try2m[,1:4],1, mad.na) <= 0)
try2m.good
par(mfrow = c(1,2))#
par(cex=1.4)#
plot(ecdf(apply(try2m[,1:4],1, sd)), main = nrow(rainCluster), col = "darkred", cex = 0.5, xlab = "m.a.d in CT units")#
#
try2m.good <- subset(try2m, apply(try2m[,1:4],1, sd) <= 0)#
try2m.good
print(try2m.good)
try2m.good <- subset(try2m, apply(try2m[,1:4],1, sd) > 0)#
#
plot(ecdf(apply(try2m.good[,1:4],1, mad.na)), main = nrow(rainCluster.mad), col = "darkblue", cex = 0.5, xlab = "m.a.d in CT units")#
#
nrow(try2m)#
nrow(try2m.good)
png(file = "mad.png", units = "in", width = 5, height = 5, res = 300)#
{#
par(mfrow = c(1,2))#
par(cex=1.4)#
plot(ecdf(apply(try2m[,1:4],1, sd)), main = nrow(try2m), col = "darkred", cex = 0.5, xlab = "m.a.d in CT units")#
try2m.good <- subset(try2m, apply(try2m[,1:4],1, sd) <= 0)#
print(try2m.good)#
try2m.good <- subset(try2m, apply(try2m[,1:4],1, sd) > 0)#
#
plot(ecdf(apply(try2m.good[,1:4],1, mad.na)), main = nrow(try2m.good), col = "darkblue", cex = 0.5, xlab = "m.a.d in CT units")#
}#
dev.off()
png(file = "mad.png", units = "in", width = 6, height = 4, res = 300)#
{#
par(mfrow = c(1,2))#
par(cex=1.4)#
plot(ecdf(apply(try2m[,1:4],1, sd)), main = nrow(try2m), col = "darkred", cex = 0.5, xlab = "s.d in CT units")#
try2m.good <- subset(try2m, apply(try2m[,1:4],1, sd) <= 0)#
print(try2m.good)#
try2m.good <- subset(try2m, apply(try2m[,1:4],1, sd) > 0)#
#
plot(ecdf(apply(try2m.good[,1:4],1, mad.na)), main = nrow(try2m.good), col = "darkblue", cex = 0.5, xlab = "s.d. in CT units")#
}#
dev.off()
png(file = "mad.png", units = "in", width = 6, height = 4, res = 300)#
{#
par(mfrow = c(1,2))#
par(cex=1.2)#
plot(ecdf(apply(try2m[,1:4],1, sd)), main = nrow(try2m), col = "darkred", cex = 0.5, xlab = "s.d in CT units")#
try2m.good <- subset(try2m, apply(try2m[,1:4],1, sd) <= 0)#
print(try2m.good)#
try2m.good <- subset(try2m, apply(try2m[,1:4],1, sd) > 0)#
#
plot(ecdf(apply(try2m.good[,1:4],1, mad.na)), main = nrow(try2m.good), col = "darkblue", cex = 0.5, xlab = "s.d. in CT units")#
}#
dev.off()
png(file = "mad.png", units = "in", width = 7, height = 4, res = 300)#
{#
par(mfrow = c(1,2))#
par(cex=1.2)#
plot(ecdf(apply(try2m[,1:4],1, sd)), main = nrow(try2m), col = "darkred", cex = 0.5, xlab = "s.d in CT units")#
try2m.good <- subset(try2m, apply(try2m[,1:4],1, sd) <= 0)#
print(try2m.good)#
try2m.good <- subset(try2m, apply(try2m[,1:4],1, sd) > 0)#
#
plot(ecdf(apply(try2m.good[,1:4],1, mad.na)), main = nrow(try2m.good), col = "darkblue", cex = 0.5, xlab = "s.d. in CT units")#
}#
dev.off()
png(file = "mad.png", units = "in", width = 7, height = 4, res = 300)#
{#
par(mfrow = c(1,2))#
par(cex=1.2)#
plot(ecdf(apply(try2m[,1:4],1, sd)), main = nrow(try2m), col = "darkred", cex = 0.5, xlab = "s.d in CT units", xlim = c(0,10))#
try2m.good <- subset(try2m, apply(try2m[,1:4],1, sd) <= 0)#
print(try2m.good)#
try2m.good <- subset(try2m, apply(try2m[,1:4],1, sd) > 0)#
#
plot(ecdf(apply(try2m.good[,1:4],1, mad.na)), main = nrow(try2m.good), col = "darkblue", cex = 0.5, xlab = "s.d. in CT units", xlim = c(0,10))#
}#
dev.off()
png(file = "mad.png", units = "in", width = 4, height = 7, res = 300)#
{#
par(mfrow = c(2,1))#
par(cex=1.2)#
plot(ecdf(apply(try2m[,1:4],1, sd)), main = nrow(try2m), col = "darkred", cex = 0.5, xlab = "s.d in CT units", xlim = c(0,10))#
try2m.good <- subset(try2m, apply(try2m[,1:4],1, sd) <= 0)#
print(try2m.good)#
try2m.good <- subset(try2m, apply(try2m[,1:4],1, sd) > 0)#
#
plot(ecdf(apply(try2m.good[,1:4],1, mad.na)), main = nrow(try2m.good), col = "darkblue", cex = 0.5, xlab = "s.d. in CT units", xlim = c(0,10))#
}#
dev.off()
png(file = "mad.png", units = "in", width = 4, height = 7, res = 300)#
{#
par(mfrow = c(2,1))#
par(cex=1.4)#
plot(ecdf(apply(try2m[,1:4],1, sd)), main = nrow(try2m), col = "darkred", cex = 0.5, xlab = "s.d in CT units", xlim = c(0,10))#
try2m.good <- subset(try2m, apply(try2m[,1:4],1, sd) <= 0)#
print(try2m.good)#
try2m.good <- subset(try2m, apply(try2m[,1:4],1, sd) > 0)#
#
plot(ecdf(apply(try2m.good[,1:4],1, mad.na)), main = nrow(try2m.good), col = "darkblue", cex = 0.5, xlab = "s.d. in CT units", xlim = c(0,10))#
}#
dev.off()
png(file = "mad.png", units = "in", width = 4, height = 7, res = 300)#
{#
par(mfrow = c(2,1))#
par(cex=1.0)#
plot(ecdf(apply(try2m[,1:4],1, sd)), main = nrow(try2m), col = "darkred", cex = 0.5, xlab = "s.d in CT units", xlim = c(0,10))#
try2m.good <- subset(try2m, apply(try2m[,1:4],1, sd) <= 0)#
print(try2m.good)#
try2m.good <- subset(try2m, apply(try2m[,1:4],1, sd) > 0)#
#
plot(ecdf(apply(try2m.good[,1:4],1, mad.na)), main = nrow(try2m.good), col = "darkblue", cex = 0.5, xlab = "s.d. in CT units", xlim = c(0,10))#
}#
dev.off()
par(mfrow = c(2,1))#
par(cex=1.0)#
plot(ecdf(apply(try2m[,1:4],1, sd)), main = nrow(try2m), col = "darkred", cex = 0.5, xlab = "s.d in CT units", xlim = c(0,10))#
abline(v = median(apply(try2m[,1:4],1, sd)))#
try2m.good <- subset(try2m, apply(try2m[,1:4],1, sd) <= 0)#
print(try2m.good)#
try2m.good <- subset(try2m, apply(try2m[,1:4],1, sd) > 0)#
#
plot(ecdf(apply(try2m.good[,1:4],1, mad.na)), main = nrow(try2m.good), col = "darkblue", cex = 0.5, xlab = "s.d. in CT units", xlim = c(0,10))
par(mfrow = c(2,1))#
par(cex=1.0)#
plot(ecdf(apply(try2m[,1:4],1, sd)), main = nrow(try2m), col = "darkred", cex = 0.5, xlab = "s.d in CT units", xlim = c(0,10))#
abline(v = median(apply(try2m[,1:4],1, sd)), col = "darkgray", lty = 2)#
try2m.good <- subset(try2m, apply(try2m[,1:4],1, sd) <= 0)#
print(try2m.good)#
try2m.good <- subset(try2m, apply(try2m[,1:4],1, sd) > 0)#
#
plot(ecdf(apply(try2m.good[,1:4],1, mad.na)), main = nrow(try2m.good), col = "darkblue", cex = 0.5, xlab = "s.d. in CT units", xlim = c(0,10))
png(file = "mad.png", units = "in", width = 4, height = 7, res = 300)#
{#
par(mfrow = c(2,1))#
par(cex=1.0)#
plot(ecdf(apply(try2m[,1:4],1, sd)), main = nrow(try2m), col = "darkred", cex = 0.5, xlab = "s.d in CT units", xlim = c(0,10))#
abline(v = median(apply(try2m[,1:4],1, sd)), col = "darkgray", lty = 2)#
try2m.good <- subset(try2m, apply(try2m[,1:4],1, sd) <= 0)#
print(try2m.good)#
try2m.good <- subset(try2m, apply(try2m[,1:4],1, sd) > 0)#
#
plot(ecdf(apply(try2m.good[,1:4],1, mad.na)), main = nrow(try2m.good), col = "darkblue", cex = 0.5, xlab = "s.d. in CT units", xlim = c(0,10))#
abline(v = median(apply(try2m.good[,1:4],1, sd)), col = "darkgray", lty = 2)#
}#
dev.off()
par(mfrow = c(2,1))#
par(cex=1.0)#
par(bty="n")#
plot(ecdf(apply(try2m[,1:4],1, sd)), main = nrow(try2m), col = "darkred", cex = 0.5, xlab = "s.d in CT units", xlim = c(0,10))#
abline(v = median(apply(try2m[,1:4],1, sd)), col = "darkgray", lty = 2)#
try2m.good <- subset(try2m, apply(try2m[,1:4],1, sd) <= 0)#
print(try2m.good)#
try2m.good <- subset(try2m, apply(try2m[,1:4],1, sd) > 0)#
#
plot(ecdf(apply(try2m.good[,1:4],1, mad.na)), main = nrow(try2m.good), col = "darkblue", cex = 0.5, xlab = "s.d. in CT units", xlim = c(0,10))#
abline(v = median(apply(try2m.good[,1:4],1, sd)), col = "darkgray", lty = 2)
par(mfrow = c(2,1))#
par(cex=1.0)#
par(bty="l")#
plot(ecdf(apply(try2m[,1:4],1, sd)), main = nrow(try2m), col = "darkred", cex = 0.5, xlab = "s.d in CT units", xlim = c(0,10))#
abline(v = median(apply(try2m[,1:4],1, sd)), col = "darkgray", lty = 2)#
try2m.good <- subset(try2m, apply(try2m[,1:4],1, sd) <= 0)#
print(try2m.good)#
try2m.good <- subset(try2m, apply(try2m[,1:4],1, sd) > 0)#
#
plot(ecdf(apply(try2m.good[,1:4],1, mad.na)), main = nrow(try2m.good), col = "darkblue", cex = 0.5, xlab = "s.d. in CT units", xlim = c(0,10))#
abline(v = median(apply(try2m.good[,1:4],1, sd)), col = "darkgray", lty = 2)
par(mfrow = c(2,1))#
par(cex=1.0)#
plot(ecdf(apply(try2m[,1:4],1, sd)), main = nrow(try2m), col = "darkred", cex = 0.5, xlab = "s.d in CT units", xlim = c(0,10), yaxis = "i")#
abline(v = median(apply(try2m[,1:4],1, sd)), col = "darkgray", lty = 2)#
try2m.good <- subset(try2m, apply(try2m[,1:4],1, sd) <= 0)#
print(try2m.good)#
try2m.good <- subset(try2m, apply(try2m[,1:4],1, sd) > 0)#
#
plot(ecdf(apply(try2m.good[,1:4],1, mad.na)), main = nrow(try2m.good), col = "darkblue", cex = 0.5, xlab = "s.d. in CT units", xlim = c(0,10), yaxis = "i")#
abline(v = median(apply(try2m.good[,1:4],1, sd)), col = "darkgray", lty = 2)
par(mfrow = c(2,1))#
par(cex=1.0)#
plot(ecdf(apply(try2m[,1:4],1, sd)), main = nrow(try2m), col = "darkred", cex = 0.5, xlab = "s.d in CT units", xlim = c(0,10), yaxs = "i")#
abline(v = median(apply(try2m[,1:4],1, sd)), col = "darkgray", lty = 2)#
try2m.good <- subset(try2m, apply(try2m[,1:4],1, sd) <= 0)#
print(try2m.good)#
try2m.good <- subset(try2m, apply(try2m[,1:4],1, sd) > 0)#
#
plot(ecdf(apply(try2m.good[,1:4],1, mad.na)), main = nrow(try2m.good), col = "darkblue", cex = 0.5, xlab = "s.d. in CT units", xlim = c(0,10), yaxs = "i")#
abline(v = median(apply(try2m.good[,1:4],1, sd)), col = "darkgray", lty = 2)
png(file = "mad.png", units = "in", width = 4, height = 7, res = 300)#
{#
par(mfrow = c(2,1))#
par(cex=1.0)#
plot(ecdf(apply(try2m[,1:4],1, sd)), #
main = nrow(try2m), #
col = "darkred", #
cex = 0.5, #
xlab = "s.d in CT units", #
xlim = c(0,10), yaxs = "i", xaxs = "i")#
#
abline(v = median(apply(try2m[,1:4],1, sd)), #
col = "darkgray", #
lty = 2)#
try2m.good <- subset(try2m, apply(try2m[,1:4],1, sd) <= 0)#
print(try2m.good)#
try2m.good <- subset(try2m, apply(try2m[,1:4],1, sd) > 0)#
#
plot(ecdf(apply(try2m.good[,1:4],1, mad.na)), #
main = nrow(try2m.good), #
col = "darkblue", #
cex = 0.5, #
xlab = "s.d. in CT units", #
xlim = c(0,10), yaxs = "i", xaxs = "i")#
#
abline(v = median(apply(try2m.good[,1:4],1, sd)), col = "darkgray", lty = 2)#
}#
dev.off()
png(file = "mad.png", units = "in", width = 4, height = 7, res = 300)#
{#
par(mfrow = c(2,1))#
par(cex=1.0)#
par(bty="o")#
plot(ecdf(apply(try2m[,1:4],1, sd)), #
main = nrow(try2m), #
col = "darkred", #
cex = 0.5, #
xlab = "s.d in CT units", #
xlim = c(0,10), yaxs = "i", xaxs = "i")#
#
abline(v = median(apply(try2m[,1:4],1, sd)), #
col = "darkgray", #
lty = 2)#
try2m.good <- subset(try2m, apply(try2m[,1:4],1, sd) <= 0)#
print(try2m.good)#
try2m.good <- subset(try2m, apply(try2m[,1:4],1, sd) > 0)#
#
plot(ecdf(apply(try2m.good[,1:4],1, mad.na)), #
main = nrow(try2m.good), #
col = "darkblue", #
cex = 0.5, #
xlab = "s.d. in CT units", #
xlim = c(0,10), yaxs = "i", xaxs = "i")#
#
abline(v = median(apply(try2m.good[,1:4],1, sd)), col = "darkgray", lty = 2)#
}#
dev.off()
png(file = "mad.png", units = "in", width = 4, height = 7, res = 300)#
{#
par(mfrow = c(2,1))#
par(cex=1.0)#
par(bty="n")#
plot(ecdf(apply(try2m[,1:4],1, sd)), #
main = nrow(try2m), #
col = "darkred", #
cex = 0.5, #
xlab = "s.d in CT units", #
xlim = c(0,10), yaxs = "i", xaxs = "i")#
#
abline(v = median(apply(try2m[,1:4],1, sd)), #
col = "darkgray", #
lty = 2)#
try2m.good <- subset(try2m, apply(try2m[,1:4],1, sd) <= 0)#
print(try2m.good)#
try2m.good <- subset(try2m, apply(try2m[,1:4],1, sd) > 0)#
#
plot(ecdf(apply(try2m.good[,1:4],1, mad.na)), #
main = nrow(try2m.good), #
col = "darkblue", #
cex = 0.5, #
xlab = "s.d. in CT units", #
xlim = c(0,10), yaxs = "i", xaxs = "i")#
#
abline(v = median(apply(try2m.good[,1:4],1, sd)), col = "darkgray", lty = 2)#
}#
dev.off()
par(mfrow = c(2,1))#
par(cex=1.0)#
par(bty="n")#
plot(ecdf(apply(try2m[,1:4],1, sd)), #
main = nrow(try2m), #
col = "darkred", #
cex = 0.5, #
xlab = "s.d in CT units", #
xlim = c(0,10), yaxs = "i", xaxs = "i")#
#
abline(v = median(apply(try2m[,1:4],1, sd)), #
col = "darkgray", #
lty = 3)#
try2m.good <- subset(try2m, apply(try2m[,1:4],1, sd) <= 0)#
print(try2m.good)#
try2m.good <- subset(try2m, apply(try2m[,1:4],1, sd) > 0)#
#
plot(ecdf(apply(try2m.good[,1:4],1, mad.na)), #
main = nrow(try2m.good), #
col = "darkblue", #
cex = 0.5, #
xlab = "s.d. in CT units", #
xlim = c(0,10), yaxs = "i", xaxs = "i")#
#
abline(v = median(apply(try2m.good[,1:4],1, sd)), col = "darkgray", lty = 3)
plot(ecdf(apply(try2m.good[,1:4],1, mad.na)), #
main = nrow(try2m.good), #
col = "darkblue", #
cex = 0.5, #
xlab = "s.d. in CT units", #
xlim = c(0,10), yaxs = "i", xaxs = "i")#
#
abline(v = median(apply(try2m.good[,1:4],1, sd)), col = "darkgray", lty = 4)
try2m.good <- subset(try2m, apply(try2m[,1:4],1, sd) <= 0)#
print(try2m.good)#
try2m.good <- subset(try2m, apply(try2m[,1:4],1, sd) > 0)#
#
plot(ecdf(apply(try2m.good[,1:4],1, mad.na)), #
main = nrow(try2m.good), #
col = "darkblue", #
cex = 0.5, #
xlab = "s.d. in CT units", #
xlim = c(0,10), yaxs = "i", xaxs = "i")#
#
abline(v = median(apply(try2m.good[,1:4],1, sd)), col = "darkgray", lty = 5)
png(file = "mad.png", units = "in", width = 4, height = 7, res = 300)#
{#
par(mfrow = c(2,1))#
par(cex=1.0)#
par(bty="n")#
plot(ecdf(apply(try2m[,1:4],1, sd)), #
main = nrow(try2m), #
col = "darkred", #
cex = 0.5, #
xlab = "s.d in CT units", #
xlim = c(0,10), yaxs = "i", xaxs = "i")#
#
abline(v = median(apply(try2m[,1:4],1, sd)), #
col = "darkgray", #
lty = 5)#
try2m.good <- subset(try2m, apply(try2m[,1:4],1, sd) <= 0)#
print(try2m.good)#
try2m.good <- subset(try2m, apply(try2m[,1:4],1, sd) > 0)#
#
plot(ecdf(apply(try2m.good[,1:4],1, mad.na)), #
main = nrow(try2m.good), #
col = "darkblue", #
cex = 0.5, #
xlab = "s.d. in CT units", #
xlim = c(0,10), yaxs = "i", xaxs = "i")#
#
abline(v = median(apply(try2m.good[,1:4],1, sd)), col = "darkgray", lty = 5)#
}#
dev.off()
head(try2m)#
brewer.palette <- colorRampPalette(brewer.pal(11, "RdYlBu"),space = "rgb", bias = 1, interpolate = "linear")#
heatmap.plus(try2m.good[,1:8], na.rm = T, scale = "row", col = brewer.palette (55),#
hclustfun=function(m) hclust(m, method="ward"), #
distfun = function(x) dist(x, method = "manhattan"), #
margins = c(10,10), #
Colv = NA, Rowv = T, #
cexRow = 0.7, cexCol = 1.4,#
main = "", xlab = "sample", ylab = "Primer")
head(try2m)#
brewer.palette <- colorRampPalette(brewer.pal(11, "RdYlBu"),space = "rgb", bias = 1, interpolate = "linear")#
heatmap.plus(as.matrix(try2m.good[,1:8]), na.rm = T, scale = "row", col = brewer.palette (55),#
hclustfun=function(m) hclust(m, method="ward"), #
distfun = function(x) dist(x, method = "manhattan"), #
margins = c(10,10), #
Colv = NA, Rowv = T, #
cexRow = 0.7, cexCol = 1.4,#
main = "", xlab = "sample", ylab = "Primer")
try2m(mean(try2m[,5:8]<40,))
try2m[mean(try2m[,5:8]<40,]
try2m[mean(try2m[,5:8]) < 40,]
head(try2m)
try2m.good$control <- mean(try2m.good[,5:8])
try2m.good$control <- colmean(try2m.good[,5:8])
try2m.good$control <- colMeans(try2m.good[,7:8])
try2m.good$control <- colMeans(try2m.good[,6:8])
try2m.good$control <- colMeans(try2m.good[,5:8])
summary(try2m.good)
try2m.good[try2m.good$control<40,]
try2m.good[try2m.good$control<39,]
try2m.good[try2m.good$control<39.5,]
try2m.good[try2m.good$control<39.6,]
try2m.good[try2m.good$control<39.9,]
try2m.good[try2m.good$control<39.8,]
try2m.good[try2m.good$control<39.7,]
png(file = "Figure_Good_heatmap centeredPrimer.png", units = "in", width = 4, height = 20, res = 300)#
{#
head(try2m)#
brewer.palette <- colorRampPalette(brewer.pal(11, "RdYlBu"),space = "rgb", bias = 1, interpolate = "linear")#
heatmap.plus(as.matrix(try2m.good[,1:8]), na.rm = T, scale = "row", col = brewer.palette (55),#
hclustfun=function(m) hclust(m, method="ward"), #
distfun = function(x) dist(x, method = "manhattan"), #
margins = c(10,10), #
Colv = NA, Rowv = T, #
cexRow = 0.7, cexCol = 1.4,#
main = "", xlab = "sample", ylab = "Primer")#
}#
dev.off()
png(file = "Figure_Good_heatmap centeredPrimer.png", units = "in", width = 4, height = 20, res = 300)#
{#
head(try2m)#
brewer.palette <- colorRampPalette(brewer.pal(11, "RdYlBu"),space = "rgb", bias = 1, interpolate = "linear")#
heatmap.plus(as.matrix(try2m.good[,1:8]), na.rm = T, scale = "row", col = brewer.palette (25),#
hclustfun=function(m) hclust(m, method="ward"), #
distfun = function(x) dist(x, method = "manhattan"), #
margins = c(10,10), #
Colv = NA, Rowv = T, #
cexRow = 0.7, cexCol = 1.4,#
main = "", xlab = "sample", ylab = "Primer")#
}#
dev.off()
png(file = "Figure_Good_heatmap centeredPrimer.png", units = "in", width = 4, height = 20, res = 300)#
{#
head(try2m)#
brewer.palette <- colorRampPalette(brewer.pal(11, "RdYlBu"),space = "rgb", bias = 1, interpolate = "linear")#
heatmap.plus(as.matrix(try2m.good[,1:8]), na.rm = TRUE, scale = "row", col = brewer.palette (25),#
hclustfun=function(m) hclust(m, method="ward"), #
distfun = function(x) dist(x, method = "manhattan"), #
margins = c(10,10), #
Colv = NA, Rowv = TRUE, #
cexRow = 0.7, cexCol = 1.2,#
main = "", xlab = "sample", ylab = "")#
}#
dev.off()
write.table(try2m.good,file = "good primers.txt", sep = "\t", row.names = FALSE)
filenames = c("good primers position")
filenames = c("good primers position.txt")
filenames = c("toR.txt")
rain <- read.rain(filenames)
summary(rain)
good <- read.delim("toR.txt", header = TRUE, sep = "\t")
good[,1:4] <- 40 - good[,1:4]
summary(good)
good$positive <- rowSums(good[,1:4])
attach(good)#
par(mfrow = c(2,1))#
par(cex=1.0)#
par(bty="n")#
plot(position,positive, #
main = nrow(try2m), #
col = "darkred", #
cex = 0.5, #
xlab = "s.d in CT units", #
xlim = c(0,10), yaxs = "i", xaxs = "i")#
#
abline(v = median(apply(try2m[,1:4],1, sd)), #
col = "darkgray", #
lty = 5)#
#
detach(good)
attach(good)#
par(mfrow = c(2,1))#
par(cex=1.0)#
par(bty="n")#
plot(position,positive, #
main = nrow(try2m), #
col = "darkred", #
cex = 0.5, #
xlab = "s.d in CT units", #
yaxs = "i", xaxs = "i")#
#
abline(h = median(good$positive), #
col = "darkgray", #
lty = 5)#
#
detach(good)
attach(good)#
par(mfrow = c(1,1))#
par(cex=1.0)#
par(bty="n")#
plot(position,positive, #
main = nrow(good), #
col = "darkred", #
cex = 0.5, #
xlab = "genome position", #
yaxs = "i", xaxs = "i")#
#
abline(h = median(good$positive), #
col = "darkgray", #
lty = 5)#
#
detach(good)
attach(good)#
par(mfrow = c(1,1))#
par(cex=1.0)#
par(bty="o")#
plot(position,positive, #
main = nrow(good), #
col = "darkred", #
cex = 0.5, #
xlab = "genome position", #
yaxs = "i", xaxs = "i")#
#
abline(h = median(good$positive), #
col = "darkgray", #
lty = 5)#
#
detach(good)
attach(good)#
par(mfrow = c(1,1))#
par(cex=1.0)#
par(bty="o")#
plot(position,#
main = nrow(good), #
col = "darkred", #
cex = 0.5, #
xlab = "genome position", #
yaxs = "i", xaxs = "i")#
#
abline(h = median(good$positive), #
col = "darkgray", #
lty = 5)#
#
detach(good)
attach(good)#
par(mfrow = c(1,1))#
par(cex=1.0)#
par(bty="o")#
plot(position,positive, #
main = nrow(good), #
type = "s",#
col = "darkred", #
cex = 0.5, #
xlab = "genome position", #
yaxs = "i", xaxs = "i")#
#
abline(h = median(good$positive), #
col = "darkgray", #
lty = 5)#
#
detach(good)
good[order(good$position)]
good[order(good$position),]
good <- good[order(good$position),]
good <- good[order(good$position),]	#
attach(good)#
par(mfrow = c(1,1))#
par(cex=1.0)#
par(bty="o")#
plot(position,positive, #
main = nrow(good), #
type = "s",#
col = "darkred", #
cex = 0.5, #
xlab = "genome position", #
yaxs = "i", xaxs = "i")#
#
abline(h = median(good$positive), #
col = "darkgray", #
lty = 5)#
#
detach(good)
good <- good[order(good$position),]	#
attach(good)#
par(mfrow = c(1,1))#
par(cex=1.0)#
par(bty="o")#
plot(position,positive, #
main = nrow(good), #
type = "h",#
col = "darkred", #
cex = 0.5, #
xlab = "genome position", #
yaxs = "i", xaxs = "i")#
#
abline(h = median(good$positive), #
col = "darkgray", #
lty = 5)#
#
detach(good)
good <- good[order(good$position),]	#
attach(good)#
par(mfrow = c(1,1))#
par(cex=1.0)#
par(bty="o")#
plot(position,positive, #
main = nrow(good), #
type = "h",#
col = "darkred", #
cex = 0.5, #
lwd = 2#
xlab = "genome position", #
ylim = c(0,1)#
yaxs = "i", xaxs = "i")#
#
abline(h = median(good$positive), #
col = "darkgray", #
lty = 5)#
#
detach(good)
good <- good[order(good$position),]	#
attach(good)#
par(mfrow = c(1,1))#
par(cex=1.0)#
par(bty="o")#
plot(position,positive, #
main = nrow(good), #
type = "h",#
col = "darkred", #
cex = 0.5, #
lwd = 2#
xlab = "genome position", #
ylim = c(0,1),#
yaxs = "i", xaxs = "i")#
#
abline(h = median(good$positive), #
col = "darkgray", #
lty = 5)#
#
detach(good)
good <- good[order(good$position),]	#
attach(good)#
par(mfrow = c(1,1))#
par(cex=1.0)#
par(bty="o")#
plot(position,positive, #
main = nrow(good), #
type = "h",#
col = "darkred", #
cex = 0.5, #
lwd = 2,#
xlab = "genome position", #
ylim = c(0,1),#
yaxs = "i", xaxs = "i")#
#
abline(h = median(good$positive), #
col = "darkgray", #
lty = 5)#
#
detach(good)
good <- good[order(good$position),]	#
attach(good)#
par(mfrow = c(2,1))#
par(cex=1.0)#
par(bty="o")#
plot(position,positive, #
main = nrow(good), #
type = "h",#
col = "darkred", #
cex = 0.5, #
lwd = 2,#
xlab = "genome position", #
ylim = c(0,1),#
yaxs = "i", xaxs = "i")#
#
abline(h = median(good$positive), #
col = "darkgray", #
lty = 5)#
#
detach(good)
good <- good[order(good$position),]	#
attach(good)#
par(mfrow = c(2,1))#
par(cex=1.0)#
par(bty="o")#
plot(position,positive, #
main = nrow(good), #
type = "h",#
col = "darkred", #
cex = 0.5, #
lwd = 2,#
xlab = "genome position", #
ylim = c(0,1),#
xlim = c(100,140000)#
yaxs = "i", xaxs = "i")#
#
abline(h = median(good$positive), #
col = "darkgray", #
lty = 5)#
#
detach(good)
good <- good[order(good$position),]	#
attach(good)#
par(mfrow = c(2,1))#
par(cex=1.0)#
par(bty="o")#
plot(position,positive, #
main = nrow(good), #
type = "h",#
col = "darkred", #
cex = 0.5, #
lwd = 2,#
xlab = "genome position", #
ylim = c(0,1),#
xlim = c(100,140000),#
yaxs = "i", xaxs = "i")#
#
abline(h = median(good$positive), #
col = "darkgray", #
lty = 5)#
#
detach(good)
good <- good[order(good$position),]	#
attach(good)#
par(mfrow = c(2,1))#
par(cex=1.0)#
par(bty="o")#
plot(position,positive, #
main = nrow(good), #
type = "h",#
col = "darkred", #
cex = 0.5, #
lwd = 2,#
xlab = "genome position", #
ylim = c(0,1),#
xlim = c(100,130000),#
yaxs = "i", xaxs = "i")#
#
abline(h = median(good$positive), #
col = "darkgray", #
lty = 5)#
#
detach(good)
good <- good[order(good$position),]	#
attach(good)#
par(mfrow = c(2,1))#
par(cex=1.0)#
par(bty="o")#
plot(position,positive, #
main = nrow(good), #
type = "h",#
col = "darkred", #
cex = 0.5, #
lwd = 2,#
xlab = "genome position", #
ylim = c(0,1),#
las = 2,#
xlim = c(100,130000),#
yaxs = "i", xaxs = "i")#
#
abline(h = median(good$positive), #
col = "darkgray", #
lty = 5)#
#
detach(good)
png(file = "position.png", units = "in", width = 8, height = 4, res = 300)#
{#
good <- good[order(good$position),]	#
attach(good)#
par(mfrow = c(2,1))#
par(cex=1.0)#
par(bty="o")#
plot(position,positive, #
main = nrow(good), #
type = "h",#
col = "darkred", #
cex = 0.5, #
lwd = 2,#
xlab = "genome position", #
ylim = c(0,1),#
las = 2,#
xlim = c(100,130000),#
yaxs = "i", xaxs = "i")#
#
abline(h = median(good$positive), #
col = "darkgray", #
lty = 5)#
#
detach(good)#
}#
dev.off()
png(file = "position.png", units = "in", width = 8, height = 4, res = 300)#
{#
good <- good[order(good$position),]	#
attach(good)#
par(mfrow = c(1,1))#
par(cex=1.0)#
par(bty="o")#
plot(position,positive, #
main = nrow(good), #
type = "h",#
col = "darkred", #
cex = 0.5, #
lwd = 2,#
xlab = "genome position", #
ylim = c(0,1),#
las = 2,#
xlim = c(100,130000),#
yaxs = "i", xaxs = "i")#
#
abline(h = median(good$positive), #
col = "darkgray", #
lty = 5)#
#
detach(good)#
}#
dev.off()
png(file = "position.png", units = "in", width = 16, height = 4, res = 300)#
{#
good <- good[order(good$position),]	#
attach(good)#
par(mfrow = c(1,1))#
par(cex=1.0)#
par(bty="o")#
plot(position,positive, #
main = nrow(good), #
type = "h",#
col = "darkred", #
cex = 0.5, #
lwd = 2,#
xlab = "genome position", #
ylim = c(0,1),#
las = 2,#
xlim = c(100,130000),#
yaxs = "i", xaxs = "i")#
#
abline(h = median(good$positive), #
col = "darkgray", #
lty = 5)#
#
detach(good)#
}#
dev.off()
png(file = "position.png", units = "in", width = 16, height = 4, res = 300)#
{#
good <- good[order(good$position),]	#
attach(good)#
par(mfrow = c(1,1))#
par(cex=1.0)#
par(bty="o")#
plot(position,positive, #
main = nrow(good), #
type = "h",#
col = "darkred", #
cex = 0.5, #
lwd = 2,#
xlab = "", #
ylim = c(0,1),#
las = 2,#
xlim = c(100,130000),#
yaxs = "i", xaxs = "i")#
#
abline(h = median(good$positive), #
col = "darkgray", #
lty = 5)#
#
detach(good)#
}#
dev.off()
png(file = "position.png", units = "in", width = 16, height = 4, res = 300)#
{#
good <- good[order(good$position),]	#
attach(good)#
par(mfrow = c(1,1))#
par(cex=1.0)#
par(bty="o")#
plot(position,positive, #
main = nrow(good), #
type = "h",#
col = "darkred", #
cex = 2, #
lwd = 2,#
xlab = "", #
ylim = c(0,1),#
las = 2,#
xlim = c(100,130000),#
yaxs = "i", xaxs = "i")#
#
abline(h = median(good$positive), #
col = "darkgray", #
lty = 5)#
#
detach(good)#
}#
dev.off()
png(file = "position.png", units = "in", width = 16, height = 4, res = 300)#
{#
good <- good[order(good$position),]	#
attach(good)#
par(mfrow = c(1,1))#
par(cex=1.0)#
par(bty="o")#
par(cex = 2)#
plot(position,positive, #
main = nrow(good), #
type = "h",#
col = "darkred", #
cex = 2, #
lwd = 2,#
xlab = "", #
ylim = c(0,1),#
las = 2,#
xlim = c(100,130000),#
yaxs = "i", xaxs = "i")#
#
abline(h = median(good$positive), #
col = "darkgray", #
lty = 5)#
#
detach(good)#
}#
dev.off()
