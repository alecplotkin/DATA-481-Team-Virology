source("/Users/dirk/DittmerSync/paper 2014 array Malawi Array/R Try1 heatmap n16/try1 heatmap n16.R")
library(gdata)
library(MASS)
library(RColorBrewer)
library(psych)
library(FactoMineR)
library(heatmap.plus)
library(vegan)
source("http://bioconductor.org/biocLite.R")
options(digits=3)
setwd("/Users/dirk/DittmerSync/paper 2014 array Malawi Array/R Try1 heatmap n16")
read.read.exceldata <- function(x)#
{#
	filnamelistlength <- length(x)#
	mir <- read.xlsx(x[1], sheetIndex=1)#
	mir$filename <- factor(x[1])#
	rain <- mir#
	print(nrow(rain))#
	if (filnamelistlength< 2) return (rain)#
	for (i in 2:filnamelistlength)#
	{#
	mir <- read.xlsx(x[i], sheetIndex=1)#
	mir$filename <- factor(x[i])#
	rain <- rbind(rain,mir)#
	print(nrow(rain))#
	}	#
	return (rain)#
}
read.exceldata <- function(x)#
{#
	filnamelistlength <- length(x)#
	mir <- read.xlsx(x[1], sheetIndex=1)#
	mir$filename <- factor(x[1])#
	rain <- mir#
	print(nrow(rain))#
	if (filnamelistlength< 2) return (rain)#
	for (i in 2:filnamelistlength)#
	{#
	mir <- read.xlsx(x[i], sheetIndex=1)#
	mir$filename <- factor(x[i])#
	rain <- rbind(rain,mir)#
	print(nrow(rain))#
	}	#
	return (rain)#
}#
filenames <- c("a.xlsx","b.xlsx")#
rain <- read.exceldata(filenames)#
#
summary(rain)#
head(rain)#
table(rain$filename)
read.exceldata <- function(x)#
{#
	filnamelistlength <- length(x)#
	mir <- read.xlsx(x[1], sheetIndex=1)#
	mir$filename <- factor(x[1])#
	rain <- mir#
	print(nrow(rain))#
	if (filnamelistlength< 2) return (rain)#
	for (i in 2:filnamelistlength)#
	{#
	mir <- read.xlsx(x[i], sheetIndex=1)#
	mir$filename <- factor(x[i])#
	rain <- rbind(rain,mir)#
	print(nrow(rain))#
	}	#
	return (rain)#
}
filenames <- c("a.xlsx","b.xlsx")
rain <- read.exceldata(filenames)
library(xlsx)
filenames <- c("a.xlsx","b.xlsx")#
rain <- read.exceldata(filenames)#
#
summary(rain)#
head(rain)#
table(rain$filename)
rainall <- rain#
write.table(rainall,file = "CompleteDataSet_CT.txt", sep = "\t", row.names = FALSE)#
rain <- rainall#
head(rain)#
colnames(rain)#
#
colnames(rain) <- c("Primer","629","731","1314","1700","2572","2741","2858","2910","2969","3544","3937","4428","4678","5485","7121","8239","filename" )#
rain <- rain[,-ncol(rain)]  #
summary(rain)
nrow(rain)#
nrow(is.na(rain))#
nrow(rain) == nrow(is.na(rain))#
nrow(rain)#
length(complete.cases(rain))#
nrow(rain) == length(complete.cases(rain))#
nrow(rain)#
rain[duplicated(rain[,"Primer"]),]#
rain <- rain[-144,]#
#
summary(rain)#
rain.wide <- na.omit(rain)#
rownames(rain.wide) <- rain.wide$Primer#
rownames(rain.wide)#
head(rain.wide)#
summary(rain.wide)#
colnames(rain.wide)#
par(mfrow = c(1,1))#
par(bty = "n")#
par(cex=1.8)#
#
mean <- rowMeans(rain.wide[,2:ncol(rain.wide)], na.rm = TRUE)#
plot(density(mean), main = "", col = "red", lwd = 2)#
par(new = FALSE)
rain.wide$mean <- rowMeans(rain.wide[,2:ncol(rain.wide)])
subset(rain.wide,rain.wide$mean>40)
subset(rain.wide,rain.wide$mean>45)
rain.wide[rain.wide$mean>45,]
par(mfrow = c(1,2))#
par(cex=1.7)#
par(bty="l")#
plot(ecdf(apply( rain.wide[,c(2:2:ncol(rain.wide))] ,1, FUN = mean, na.rm = TRUE)), col = "darkblue", verticals = TRUE, do.points = FALSE, lwd = 2, main = "a.", xlab = "mean CT' / primer", ylab = "Culm. density", las = 1, xlim = c(20, 50))    #
histSpike(apply(rain.wide[,c(2:2:ncol(rain.wide))] ,1, FUN = mean, na.rm = TRUE), add=TRUE, col = "darkred", frac = 0.2, lwd = 4)#
#
abline(v = 21, lty =3, col = "darkgreen")#
text(25,0,".", col = "darkgreen")#
text(25,1.0,".", col = "darkgreen")#
par(cex=1.7)#
par(bty = "l")#
plot( #
apply(rain.wide[,c(2:ncol(rain.wide))],1, mean, na.rm = TRUE), #
apply(rain.wide[,c(2:ncol(rain.wide))],1, sd, na.rm = TRUE),#
pch = 16,#
cex=1,#
ylim = c(0,8),#
xlim = c(20, 50),#
col = "darkred",  #
lwd = 2, #
las = 1,#
main = "b.", #
ylab = "sd CT' / primer", #
xlab = "mean CT' / primer")#
#
abline(h = 2, lty =2, col = "lightgray")#
abline(h = 4, lty =2, col = "lightgray")#
abline(h = 6, lty =2, col = "lightgray")#
abline(h = 8, lty =2, col = "lightgray")
colnames(rain.wide)#
rain.wide$mean <- rowMeans(rain.wide[,2:ncol(rain.wide)])#
rain.wide[rain.wide$mean>=50,]
colnames(rain.wide)
library(Hmisc)
png(file = "PrimerPerformance.png", units = "in", width = 10, height = 6, res = 300)#
{#
par(mfrow = c(1,2))#
par(cex=1.7)#
par(bty="l")#
plot(ecdf(apply( rain.wide[,c(2:2:ncol(rain.wide))] ,1, FUN = mean, na.rm = TRUE)), col = "darkblue", verticals = TRUE, do.points = FALSE, lwd = 2, main = "a.", xlab = "mean CT' / primer", ylab = "Culm. density", las = 1, xlim = c(20, 50))    #
histSpike(apply(rain.wide[,c(2:2:ncol(rain.wide))] ,1, FUN = mean, na.rm = TRUE), add=TRUE, col = "darkred", frac = 0.2, lwd = 4)#
#
abline(v = 21, lty =3, col = "darkgreen")#
text(25,0,".", col = "darkgreen")#
text(25,1.0,".", col = "darkgreen")#
par(cex=1.7)#
par(bty = "l")#
plot( #
apply(rain.wide[,c(2:ncol(rain.wide))],1, mean, na.rm = TRUE), #
apply(rain.wide[,c(2:ncol(rain.wide))],1, sd, na.rm = TRUE),#
pch = 16,#
cex=1,#
ylim = c(0,8),#
xlim = c(20, 50),#
col = "darkred",  #
lwd = 2, #
las = 1,#
main = "b.", #
ylab = "sd CT' / primer", #
xlab = "mean CT' / primer")#
#
abline(h = 2, lty =2, col = "lightgray")#
abline(h = 4, lty =2, col = "lightgray")#
abline(h = 6, lty =2, col = "lightgray")#
abline(h = 8, lty =2, col = "lightgray")#
}#
dev.off()
head(rain.wide)
rain.wide <- rain.wide[,-ncol(rain.wide)]
library(gdata)#
library(reshape2)#
library(MASS)#
library(RColorBrewer)#
library(psych)#
library(FactoMineR)#
library(heatmap.plus)#
library(DMwR)#
library(Hmisc)#
library(vegan)#
#
library(xlsx)#
options(digits=3)#
setwd("/Users/dirk/DittmerSync/paper 2014 array Malawi Array/R Try1 heatmap n16")#
read.exceldata <- function(x)#
{#
	filnamelistlength <- length(x)#
	mir <- read.xlsx(x[1], sheetIndex=1)#
	mir$filename <- factor(x[1])#
	rain <- mir#
	print(nrow(rain))#
	if (filnamelistlength< 2) return (rain)#
	for (i in 2:filnamelistlength)#
	{#
	mir <- read.xlsx(x[i], sheetIndex=1)#
	mir$filename <- factor(x[i])#
	rain <- rbind(rain,mir)#
	print(nrow(rain))#
	}	#
	return (rain)#
}#
filenames <- c("a.xlsx","b.xlsx")#
rain <- read.exceldata(filenames)#
#
summary(rain)#
head(rain)#
table(rain$filename)#
rainall <- rain#
write.table(rainall,file = "CompleteDataSet_CT.txt", sep = "\t", row.names = FALSE)#
rain <- rainall#
head(rain)#
colnames(rain)#
#
colnames(rain) <- c("Primer","629","731","1314","1700","2572","2741","2858","2910","2969","3544","3937","4428","4678","5485","7121","8239","filename" )#
rain <- rain[,-ncol(rain)]  #
summary(rain)#
nrow(rain)#
nrow(is.na(rain))#
nrow(rain) == nrow(is.na(rain))#
nrow(rain)#
length(complete.cases(rain))#
nrow(rain) == length(complete.cases(rain))#
nrow(rain)#
rain[duplicated(rain[,"Primer"]),]#
rain <- rain[-144,]#
#
summary(rain)#
rain.wide <- na.omit(rain)#
rownames(rain.wide) <- rain.wide$Primer#
rownames(rain.wide)#
head(rain.wide)#
summary(rain.wide)#
colnames(rain.wide)#
par(mfrow = c(1,1))#
par(bty = "n")#
par(cex=1.8)#
#
mean <- rowMeans(rain.wide[,2:ncol(rain.wide)], na.rm = TRUE)#
plot(density(mean), main = "", col = "red", lwd = 2)#
par(new = FALSE)#
colnames(rain.wide)#
rain.wide$mean <- rowMeans(rain.wide[,2:ncol(rain.wide)])#
rain.wide[rain.wide$mean>=45,]#
rain.wide <- subset(rain.wide,rain.wide$mean<=45)#
rain.wide <- rain.wide[,-ncol(rain.wide)]#
colnames(rain.wide)#
png(file = "PrimerPerformance.png", units = "in", width = 10, height = 6, res = 300)#
{#
par(mfrow = c(1,2))#
par(cex=1.7)#
par(bty="l")#
plot(ecdf(apply( rain.wide[,c(2:2:ncol(rain.wide))] ,1, FUN = mean, na.rm = TRUE)), col = "darkblue", verticals = TRUE, do.points = FALSE, lwd = 2, main = "a.", xlab = "mean CT' / primer", ylab = "Culm. density", las = 1, xlim = c(20, 50))    #
histSpike(apply(rain.wide[,c(2:2:ncol(rain.wide))] ,1, FUN = mean, na.rm = TRUE), add=TRUE, col = "darkred", frac = 0.2, lwd = 4)#
#
abline(v = 21, lty =3, col = "darkgreen")#
text(25,0,".", col = "darkgreen")#
text(25,1.0,".", col = "darkgreen")#
par(cex=1.7)#
par(bty = "l")#
plot( #
apply(rain.wide[,c(2:ncol(rain.wide))],1, mean, na.rm = TRUE), #
apply(rain.wide[,c(2:ncol(rain.wide))],1, sd, na.rm = TRUE),#
pch = 16,#
cex=1,#
ylim = c(0,8),#
xlim = c(20, 50),#
col = "darkred",  #
lwd = 2, #
las = 1,#
main = "b.", #
ylab = "sd CT' / primer", #
xlab = "mean CT' / primer")#
#
abline(h = 2, lty =2, col = "lightgray")#
abline(h = 4, lty =2, col = "lightgray")#
abline(h = 6, lty =2, col = "lightgray")#
abline(h = 8, lty =2, col = "lightgray")#
}#
dev.off()#
head(rain.wide)#
colnames(rain.wide)#
GLOBAL.allnumericStart = 2
rain.wide <- as.matrix(rain.wide[,GLOBAL.allnumericStart:ncol(rain.wide)])#
rain.wide <- t(rain.wide)#
head(rain.wide)
rain <- as.data.frame(rain.wide)#
head(rain[,1:4])
head(rain)#
colnames(rain)
head(rain)#
colnames(rain)#
rain2 <- rain[,c("BACT_2","B2M_2","ACTIN_2")]#
#
rain2
rownames(rain2)#
house <- as.matrix(rain2)#
house
par(cex=1.7)#
par(bty = "l")#
plot( #
apply(rain.wide[,c(2:ncol(rain.wide))],1, mean, na.rm = TRUE), #
apply(rain.wide[,c(2:ncol(rain.wide))],1, sd, na.rm = TRUE),#
pch = 16,#
cex=1,#
#
xlim = c(20, 50),#
col = "darkred",  #
lwd = 2, #
las = 1,#
main = "b.", #
ylab = "sd CT' / primer", #
xlab = "mean CT' / primer")#
#
abline(h = 2, lty =2, col = "lightgray")#
abline(h = 4, lty =2, col = "lightgray")#
abline(h = 6, lty =2, col = "lightgray")#
abline(h = 8, lty =2, col = "lightgray")#
}#
dev.off()
png(file = "PrimerPerformance.png", units = "in", width = 10, height = 6, res = 300)#
{#
par(mfrow = c(1,2))#
par(cex=1.7)#
par(bty="l")#
plot(ecdf(apply( rain.wide[,c(2:2:ncol(rain.wide))] ,1, FUN = mean, na.rm = TRUE)), col = "darkblue", verticals = TRUE, do.points = FALSE, lwd = 2, main = "a.", xlab = "mean CT' / primer", ylab = "Culm. density", las = 1, xlim = c(20, 50))    #
histSpike(apply(rain.wide[,c(2:2:ncol(rain.wide))] ,1, FUN = mean, na.rm = TRUE), add=TRUE, col = "darkred", frac = 0.2, lwd = 4)#
#
abline(v = 21, lty =3, col = "darkgreen")#
text(25,0,".", col = "darkgreen")#
text(25,1.0,".", col = "darkgreen")#
par(cex=1.7)#
par(bty = "l")#
plot( #
apply(rain.wide[,c(2:ncol(rain.wide))],1, mean, na.rm = TRUE), #
apply(rain.wide[,c(2:ncol(rain.wide))],1, sd, na.rm = TRUE),#
pch = 16,#
cex=1,#
#
xlim = c(20, 50),#
col = "darkred",  #
lwd = 2, #
las = 1,#
main = "b.", #
ylab = "sd CT' / primer", #
xlab = "mean CT' / primer")#
#
abline(h = 2, lty =2, col = "lightgray")#
abline(h = 4, lty =2, col = "lightgray")#
abline(h = 6, lty =2, col = "lightgray")#
abline(h = 8, lty =2, col = "lightgray")#
}#
dev.off()
house.cor <- cor(house,use="complete.obs",method="pearson")#
cor.plot(house.cor, main = "Housekeeping genes", zlim = c(0.8,1), cex.axis = 1.0, n = 32)#
house.cor <- mat.sort(house.cor)#
head(house.cor)#
cor.plot(house.cor, main = "Housekeeping Genes", zlim = c(0,1), cex.axis = 1.0, n = 32)#
house
cor.plot(house.cor, main = "Housekeeping Genes", cex.axis = 1.0, n = 32)
house.cor <- mat.sort(house.cor)#
head(house.cor)#
cor.plot(house.cor, main = "Housekeeping Genes", zlim = c(0,1), cex.axis = 1.0, n = 32)#
house
house.cor <- mat.sort(house.cor)#
head(house.cor)#
cor.plot(house.cor, main = "Housekeeping Genes", zlim = c(0.5,1), cex.axis = 1.0, n = 32)#
house
for (i in GLOBAL.allnumericStart:ncol(rain))#
	{#
	rain[,i] <- 		rain[,"house"] - rain[,i]#
	}#
#
summary(rain)#
write.table(rain,file = "dCT.txt", sep = "\t",row.names = FALSE)#
rownames(rain)
par(mfrow = c(1,1))#
par(cex = 1.5)#
par(bty = "l")#
#
plot(ecdf(apply(rain[,GLOBAL.allnumericStart:ncol(rain)],2, sd)), col = "darkred", verticals = TRUE, do.points = FALSE, lwd = 2, main = "positive dilutions (DNA)", xlab = "sd of dCT'", xlim = c(0,10), lty =1, cex = 2, las = 1)    #
#
histSpike(apply(rain[22:25,GLOBAL.allnumericStart:ncol(rain)],2, sd), add=TRUE, col = "darkgray", frac = 0.3, lwd = 5)
par(mfrow = c(1,1))#
par(cex = 1.5)#
par(bty = "l")#
#
plot(ecdf(apply(rain[,GLOBAL.allnumericStart:ncol(rain)],2, sd)), col = "darkred", verticals = TRUE, do.points = FALSE, lwd = 2, main = "positive dilutions (DNA)", xlab = "sd of dCT'", xlim = c(0,10), lty =1, cex = 2, las = 1)    #
#
histSpike(apply(rain[,GLOBAL.allnumericStart:ncol(rain)],2, sd), add=TRUE, col = "darkgray", frac = 0.3, lwd = 5)
png(file = "AlteredGenesBasedonSDofdCT'.png", units = "in", width = 8, height = 12, res = 300)#
{#
par(mfrow = c(1,1))#
par(cex = 1.5)#
par(bty = "l")#
#
plot(ecdf(apply(rain[,GLOBAL.allnumericStart:ncol(rain)],2, sd)), col = "darkred", verticals = TRUE, do.points = FALSE, lwd = 2, main = "", xlab = "s.d. of dCT'", ylab = "Culm. Density'", xlim = c(0,10), lty =1, cex = 2, las = 1)    #
#
histSpike(apply(rain[,GLOBAL.allnumericStart:ncol(rain)],2, sd), add=TRUE, col = "darkgray", frac = 0.3, lwd = 5)#
}#
dev.off()#
#
head(rain[,1:4])
png(file = "AlteredGenesBasedonSDofdCT'.png", units = "in", width = 6, height = 6, res = 300)#
{#
par(mfrow = c(1,1))#
par(cex = 2)#
par(bty = "l")#
#
plot(ecdf(apply(rain[,GLOBAL.allnumericStart:ncol(rain)],2, sd)), col = "darkred", verticals = TRUE, do.points = FALSE, lwd = 2, main = "", xlab = "s.d. of dCT'", ylab = "Culm. Density'", xlim = c(0,10), lty =1, cex = 2, las = 1)    #
#
histSpike(apply(rain[,GLOBAL.allnumericStart:ncol(rain)],2, sd), add=TRUE, col = "darkgray", frac = 0.3, lwd = 5)#
}#
dev.off()
png(file = "AlteredGenesBasedonSDofdCT'.png", units = "in", width = 6, height = 6, res = 300)#
{#
par(mfrow = c(1,1))#
par(cex = 1.6)#
par(bty = "l")#
#
plot(ecdf(apply(rain[,GLOBAL.allnumericStart:ncol(rain)],2, sd)), col = "darkred", verticals = TRUE, do.points = FALSE, lwd = 2, main = "", xlab = "s.d. of dCT'", ylab = "Culm. Density", xlim = c(0,10), lty =1, cex = 2, las = 1)    #
#
histSpike(apply(rain[,GLOBAL.allnumericStart:ncol(rain)],2, sd), add=TRUE, col = "darkgray", frac = 0.3, lwd = 5)#
}#
dev.off()
par(mfrow = c(1,2))#
par(cex = 1.5)#
plot(ecdf(apply(rain[,GLOBAL.allnumericStart:ncol(rain)],1, sd)), col = "darkblue", verticals = TRUE, do.points = FALSE, lwd = 2, main = "initial", xlab = "sd CT' ")    #
#
histSpike(apply(rain[,GLOBAL.allnumericStart:ncol(rain)],1, sd), add=TRUE, col = "darkred", frac = 0.2, lwd = 3)
par(mfrow = c(1,2))#
par(cex = 1.5)#
plot(ecdf(apply(rain[,GLOBAL.allnumericStart:ncol(rain)],2, sd)), col = "darkblue", verticals = TRUE, do.points = FALSE, lwd = 2, main = "initial", xlab = "sd CT' ")    #
#
histSpike(apply(rain[,GLOBAL.allnumericStart:ncol(rain)],2, sd), add=TRUE, col = "darkred", frac = 0.2, lwd = 3)
rain <- rainall#
head(rain)#
colnames(rain)#
#
colnames(rain) <- c("Primer","629","731","1314","1700","2572","2741","2858","2910","2969","3544","3937","4428","4678","5485","7121","8239","filename" )#
rain <- rain[,-ncol(rain)]  #
summary(rain)#
nrow(rain)#
nrow(is.na(rain))#
nrow(rain) == nrow(is.na(rain))#
nrow(rain)#
length(complete.cases(rain))#
nrow(rain) == length(complete.cases(rain))#
nrow(rain)#
rain[duplicated(rain[,"Primer"]),]#
rain <- rain[-144,]#
#
summary(rain)#
rain.wide <- na.omit(rain)#
rownames(rain.wide) <- rain.wide$Primer#
rownames(rain.wide)#
head(rain.wide)#
summary(rain.wide)#
colnames(rain.wide)#
par(mfrow = c(1,1))#
par(bty = "n")#
par(cex=1.8)#
#
mean <- rowMeans(rain.wide[,2:ncol(rain.wide)], na.rm = TRUE)#
plot(density(mean), main = "", col = "red", lwd = 2)#
par(new = FALSE)#
colnames(rain.wide)#
rain.wide$mean <- rowMeans(rain.wide[,2:ncol(rain.wide)])#
rain.wide[rain.wide$mean>=45,]#
rain.wide <- subset(rain.wide,rain.wide$mean<=45)#
rain.wide <- rain.wide[,-ncol(rain.wide)]#
colnames(rain.wide)#
png(file = "PrimerPerformance.png", units = "in", width = 10, height = 6, res = 300)#
{#
par(mfrow = c(1,2))#
par(cex=1.7)#
par(bty="l")#
plot(ecdf(apply( rain.wide[,c(2:2:ncol(rain.wide))] ,1, FUN = mean, na.rm = TRUE)), col = "darkblue", verticals = TRUE, do.points = FALSE, lwd = 2, main = "a.", xlab = "mean CT' / primer", ylab = "Culm. density", las = 1, xlim = c(20, 50))    #
histSpike(apply(rain.wide[,c(2:2:ncol(rain.wide))] ,1, FUN = mean, na.rm = TRUE), add=TRUE, col = "darkred", frac = 0.2, lwd = 4)#
#
abline(v = 21, lty =3, col = "darkgreen")#
text(25,0,".", col = "darkgreen")#
text(25,1.0,".", col = "darkgreen")#
par(cex=1.7)#
par(bty = "l")#
plot( #
apply(rain.wide[,c(2:ncol(rain.wide))],1, mean, na.rm = TRUE), #
apply(rain.wide[,c(2:ncol(rain.wide))],1, sd, na.rm = TRUE),#
pch = 16,#
cex=1,#
#
xlim = c(20, 50),#
col = "darkred",  #
lwd = 2, #
las = 1,#
main = "b.", #
ylab = "sd CT' / primer", #
xlab = "mean CT' / primer")#
#
abline(h = 2, lty =2, col = "lightgray")#
abline(h = 4, lty =2, col = "lightgray")#
abline(h = 6, lty =2, col = "lightgray")#
abline(h = 8, lty =2, col = "lightgray")#
}#
dev.off()#
head(rain.wide)#
colnames(rain.wide)#
GLOBAL.allnumericStart = 2#
#
rain.wide <- as.matrix(rain.wide[,GLOBAL.allnumericStart:ncol(rain.wide)])#
rain.wide <- t(rain.wide)#
head(rain.wide)#
rain <- as.data.frame(rain.wide)#
head(rain[,1:4])#
head(rain)#
colnames(rain)#
rain2 <- rain[,c("BACT_2","B2M_2","ACTIN_2")]#
#
rain2#
rownames(rain2)#
house <- as.matrix(rain2)#
house#
splom(house, col = "darkred", pch =19, pscales=2, type=c("g","p"), main = "housekeeping genes")#
png(file = "HousekeepingGenes.png", units = "in", width = 8, height = 8, res = 300)#
{#
pairs.panels (house, #
lm = TRUE, #
ellipses = FALSE, #
hist.col = "lightgray",#
lty = 1, #
pch = 1,#
lwd = 1, #
method = "pearson", #
cex = 2, #
col = "darkred", #
cex.labels = 1,font.labels = 2,#
gap =1.2, #
las = 1,#
scale = TRUE,#
digits = 3,#
main = "Housekeeping mRNAs"#
#
)#
}#
dev.off()#
house.cor <- cor(house,use="complete.obs",method="pearson")#
cor.plot(house.cor, main = "Housekeeping genes", zlim = c(0.8,1), cex.axis = 1.0, n = 32)#
house.cor <- mat.sort(house.cor)#
head(house.cor)#
cor.plot(house.cor, main = "Housekeeping Genes", zlim = c(0.5,1), cex.axis = 1.0, n = 32)#
house#
house <- as.matrix(rain2[,c("BACT_2","B2M_2","ACTIN_2")])#
house#
geo <- as.data.frame(apply(house, 1, geometric.mean))#
colnames(geo) <- c("house")#
geo$name <- rownames(house)#
head(geo)#
geo#
#
head(rain)#
rain$name <- as.factor(rownames(rain))#
rain <- cbind(geo,rain)#
rain <- rain[,-ncol(rain)]#
rain$name <- as.factor(rain$name)#
colnames(rain)#
GLOBAL.allnumericStart <- GLOBAL.allnumericStart + 1#
GLOBAL.allnumericStart#
head(rain[,1:4])#
for (i in GLOBAL.allnumericStart:ncol(rain))#
	{#
	rain[,i] <- 		rain[,"house"] - rain[,i]#
	}#
#
summary(rain)#
write.table(rain,file = "dCT.txt", sep = "\t",row.names = FALSE)#
rownames(rain)#
png(file = "AlteredGenesBasedonSDofdCT'.png", units = "in", width = 6, height = 6, res = 300)#
{#
par(mfrow = c(1,1))#
par(cex = 1.6)#
par(bty = "l")#
#
plot(ecdf(apply(rain[,GLOBAL.allnumericStart:ncol(rain)],2, sd)), col = "darkred", verticals = TRUE, do.points = FALSE, lwd = 2, main = "", xlab = "s.d. of dCT'", ylab = "Culm. Density", xlim = c(0,10), lty =1, cex = 2, las = 1)    #
#
histSpike(apply(rain[,GLOBAL.allnumericStart:ncol(rain)],2, sd), add=TRUE, col = "darkgray", frac = 0.3, lwd = 5)#
}#
dev.off()#
#
head(rain[,1:4])#
head(rain)
subset(rain[,GLOBAL.allnumericStart:ncol(rain)], apply(rain[,GLOBAL.allnumericStart:ncol(rain)],2, sd) < 1)#
rain.2 <- subset(rain[,GLOBAL.allnumericStart:ncol(rain)], apply(rain[,GLOBAL.allnumericStart:ncol(rain)],2, sd) > 1)#
nrow(rain)#
nrow(rain.2)
rain.2 <- subset(rain[,GLOBAL.allnumericStart:ncol(rain)], apply(rain[,GLOBAL.allnumericStart:ncol(rain)],1, sd) > 1)
par(mfrow = c(1,2))#
par(cex = 1.5)#
plot(ecdf(apply(rain[,GLOBAL.allnumericStart:ncol(rain)],2, sd)), col = "darkblue", verticals = TRUE, do.points = FALSE, lwd = 2, main = nrow(rain), xlab = "sd CT' ")    #
#
histSpike(apply(rain[,GLOBAL.allnumericStart:ncol(rain)],2, sd), add=TRUE, col = "darkred", frac = 0.2, lwd = 3)#
plot(ecdf(apply(rain.2[,GLOBAL.allnumericStart:ncol(rain)],2, sd)), col = "darkblue", verticals = TRUE, do.points = FALSE, lwd = 2, main = nrow(rain.2), xlab = "CT' ")    #
#
histSpike(apply(rain.2,2, sd), add=TRUE, col = "darkred", frac = 0.2, lwd = 3)
head(rain.2)
head(rain)
plot(ecdf(apply(rain[,GLOBAL.allnumericStart:ncol(rain)],2, sd)), col = "darkblue", verticals = TRUE, do.points = FALSE, lwd = 2, main = nrow(rain), xlab = "sd CT' ")    #
#
histSpike(apply(rain[,GLOBAL.allnumericStart:ncol(rain)],2, sd), add=TRUE, col = "darkred", frac = 0.2, lwd = 3)
par(cex = 1.5)#
plot(ecdf(apply(rain[,GLOBAL.allnumericStart:ncol(rain)],2, sd)), col = "darkblue", verticals = TRUE, do.points = FALSE, lwd = 2, main = ncol(rain), xlab = "sd CT' ")
histSpike(apply(rain[,GLOBAL.allnumericStart:ncol(rain)],2, sd), add=TRUE, col = "darkred", frac = 0.2, lwd = 3)
plot(ecdf(apply(rain.2[,GLOBAL.allnumericStart:ncol(rain.2)],2, sd)), col = "darkblue", verticals = TRUE, do.points = FALSE, lwd = 2, main = nrow(rain.2), xlab = "CT' ")
histSpike(apply(rain.2,2, sd), add=TRUE, col = "darkred", frac = 0.2, lwd = 3)
png(file = "SD filter.png", units = "in", width = 8, height = 8, res = 600)#
{#
par(mfrow = c(1,2))#
par(cex = 1.5)#
plot(ecdf(apply(rain[,GLOBAL.allnumericStart:ncol(rain)],2, sd)), col = "darkblue", verticals = TRUE, do.points = FALSE, lwd = 2, main = ncol(rain), xlab = "sd CT' ")    #
histSpike(apply(rain[,GLOBAL.allnumericStart:ncol(rain)],2, sd), add=TRUE, col = "darkred", frac = 0.2, lwd = 3)#
#
plot(ecdf(apply(rain.2[,GLOBAL.allnumericStart:ncol(rain.2)],2, sd)), col = "darkblue", verticals = TRUE, do.points = FALSE, lwd = 2, main = nrow(rain.2), xlab = "CT' ")    #
histSpike(apply(rain.2,2, sd), add=TRUE, col = "darkred", frac = 0.2, lwd = 3)#
}#
dev.off()
par(mfrow = c(1,2))#
par(cex = 1.5)#
plot(ecdf(apply(rain[,GLOBAL.allnumericStart:ncol(rain)],2, sd)), col = "darkblue", verticals = TRUE, do.points = FALSE, lwd = 2, main = ncol(rain), xlab = "sd CT' ")    #
histSpike(apply(rain[,GLOBAL.allnumericStart:ncol(rain)],2, sd), add=TRUE, col = "darkred", frac = 0.2, lwd = 3)#
#
plot(ecdf(apply(rain.2[,GLOBAL.allnumericStart:ncol(rain.2)],2, sd)), col = "darkblue", verticals = TRUE, do.points = FALSE, lwd = 2, main = ncol(rain.2), xlab = "CT' ")    #
histSpike(apply(rain.2,[,GLOBAL.allnumericStart:ncol(rain.2)],2, sd)), add=TRUE, col = "darkred", frac = 0.2, lwd = 3)
histSpike(apply(rain.2[,GLOBAL.allnumericStart:ncol(rain.2)],2, sd)), add=TRUE, col = "darkred", frac = 0.2, lwd = 3)
histSpike(apply(rain.2[,GLOBAL.allnumericStart:ncol(rain.2)],2, sd), add=TRUE, col = "darkred", frac = 0.2, lwd = 3)
subset(rain, apply(rain[,GLOBAL.allnumericStart:ncol(rain)],1, sd) < 1)
png(file = "SD filter.png", units = "in", width = 8, height = 8, res = 600)#
{#
par(mfrow = c(1,2))#
par(cex = 1.5)#
plot(ecdf(apply(rain[,GLOBAL.allnumericStart:ncol(rain)],2, sd)), col = "darkblue", verticals = TRUE, do.points = FALSE, lwd = 2, main = ncol(rain), xlab = "sd CT' ")    #
histSpike(apply(rain[,GLOBAL.allnumericStart:ncol(rain)],2, sd), add=TRUE, col = "darkred", frac = 0.2, lwd = 3)#
#
plot(ecdf(apply(rain.2[,GLOBAL.allnumericStart:ncol(rain.2)],2, sd)), col = "darkblue", verticals = TRUE, do.points = FALSE, lwd = 2, main = ncol(rain.2), xlab = "CT' ")    #
histSpike(apply(rain.2[,GLOBAL.allnumericStart:ncol(rain.2)],2, sd), add=TRUE, col = "darkred", frac = 0.2, lwd = 3)#
}#
dev.off()
head(rain[,1:5])
rainCluster	<- melt(rain)
rainCluster <- na.omit(rainCluster)
rainCluster <- drop.levels(rainCluster)
colnames(rainCluster) <- c("name","Primer","value")
colnames(rainCluster) <- c("Primer","value")
summary(rainCluster)
nrow(rainCluster)
colnames(rainCluster) <- c("Primer","dCT'")
head(rainCluster)
colnames(rainCluster) <- c("Primer","dCT")
IQR(rainCluster$dCT, na.rm = TRUE)
fivenum(rainCluster$dCT, na.rm = TRUE)
shapiro.test(rainCluster$dCT)
par(mfrow = c(1,1))#
par(cex = 1.5)#
par(bty = "o")#
qqnorm(rainCluster[,"dCT"], #
pch = 19,#
cex = 0.5, #
las = 1,#
col = "darkred",#
main = "Samples")#
qqline(rainCluster[,"dCT"], col = "darkblue", lwd = 2, lty = 3)#
histSpike(rainCluster[,"dCT"], add=TRUE, col = "darkgray", frac = 0.5, lwd = 5, side =2)
abline(h = 0)
png(file = "qqPlot Of All dCT.png", units = "in", width = 8, height = 8, res = 300)#
{#
par(mfrow = c(1,1))#
par(cex = 1.8)#
par(bty = "o")#
qqnorm(rainCluster[,"dCT"], #
pch = 19,#
cex = 0.5, #
las = 1,#
col = "darkred",#
main = "Samples")#
qqline(rainCluster[,"dCT"], col = "darkblue", lwd = 2, lty = 3)#
histSpike(rainCluster[,"dCT"], add=TRUE, col = "darkgray", frac = 0.5, lwd = 5, side =2)#
#
abline(h = 0, lty =2, col = "lightgray")#
abline(v = 0, lty =2, col = "lightgray")#
}#
dev.off()
summary(rain)
levels(rain$Sample)
filenames <- c("a.xlsx","b.xlsx")#
rain <- read.exceldata(filenames)#
#
summary(rain)#
head(rain)#
table(rain$filename)#
rainall <- rain#
write.table(rainall,file = "CompleteDataSet_CT.txt", sep = "\t", row.names = FALSE)#
rain <- rainall#
head(rain)#
colnames(rain)#
#
colnames(rain) <- c("Primer","629","731","1314","1700","2572","2741","2858","2910","2969","3544","3937","4428","4678","5485","7121","8239","filename" )#
rain <- rain[,-ncol(rain)]  #
summary(rain)#
nrow(rain)#
nrow(is.na(rain))#
nrow(rain) == nrow(is.na(rain))#
nrow(rain)#
length(complete.cases(rain))#
nrow(rain) == length(complete.cases(rain))#
nrow(rain)#
rain[duplicated(rain[,"Primer"]),]#
rain <- rain[-144,]#
#
summary(rain)#
rain.wide <- na.omit(rain)#
rain.wide <- drop.levels(rain)#
rownames(rain.wide) <- rain.wide$Primer#
rownames(rain.wide)#
head(rain.wide)#
summary(rain.wide)#
colnames(rain.wide)#
par(mfrow = c(1,1))#
par(bty = "n")#
par(cex=1.8)#
#
mean <- rowMeans(rain.wide[,2:ncol(rain.wide)], na.rm = TRUE)#
plot(density(mean), main = "", col = "red", lwd = 2)#
par(new = FALSE)
colnames(rain.wide)#
rain.wide$mean <- rowMeans(rain.wide[,2:ncol(rain.wide)])#
rain.wide[rain.wide$mean>=45,]#
rain.wide <- subset(rain.wide,rain.wide$mean<=45)#
rain.wide <- rain.wide[,-ncol(rain.wide)]#
colnames(rain.wide)
png(file = "PrimerPerformance.png", units = "in", width = 10, height = 6, res = 300)#
{#
par(mfrow = c(1,2))#
par(cex=1.7)#
par(bty="l")#
plot(ecdf(apply( rain.wide[,c(2:2:ncol(rain.wide))] ,1, FUN = mean, na.rm = TRUE)), col = "darkblue", verticals = TRUE, do.points = FALSE, lwd = 2, main = "a.", xlab = "mean CT' / primer", ylab = "Culm. density", las = 1, xlim = c(20, 50))    #
histSpike(apply(rain.wide[,c(2:2:ncol(rain.wide))] ,1, FUN = mean, na.rm = TRUE), add=TRUE, col = "darkred", frac = 0.2, lwd = 4)#
#
abline(v = 21, lty =3, col = "darkgreen")#
text(25,0,".", col = "darkgreen")#
text(25,1.0,".", col = "darkgreen")#
par(cex=1.7)#
par(bty = "l")#
plot( #
apply(rain.wide[,c(2:ncol(rain.wide))],1, mean, na.rm = TRUE), #
apply(rain.wide[,c(2:ncol(rain.wide))],1, sd, na.rm = TRUE),#
pch = 16,#
cex=1,#
#
xlim = c(20, 50),#
col = "darkred",  #
lwd = 2, #
las = 1,#
main = "b.", #
ylab = "sd CT' / primer", #
xlab = "mean CT' / primer")#
#
abline(h = 2, lty =2, col = "lightgray")#
abline(h = 4, lty =2, col = "lightgray")#
abline(h = 6, lty =2, col = "lightgray")#
abline(h = 8, lty =2, col = "lightgray")#
}#
dev.off()#
head(rain.wide)#
colnames(rain.wide)#
GLOBAL.allnumericStart = 2#
#
rain.wide <- as.matrix(rain.wide[,GLOBAL.allnumericStart:ncol(rain.wide)])#
rain.wide <- t(rain.wide)#
head(rain.wide)#
rain <- as.data.frame(rain.wide)#
head(rain[,1:4])#
head(rain)#
colnames(rain)#
rain2 <- rain[,c("BACT_2","B2M_2","ACTIN_2")]#
#
rain2#
rownames(rain2)#
house <- as.matrix(rain2)#
house
splom(house, col = "darkred", pch =19, pscales=2, type=c("g","p"), main = "housekeeping genes")#
png(file = "HousekeepingGenes.png", units = "in", width = 8, height = 8, res = 300)#
{#
pairs.panels (house, #
lm = TRUE, #
ellipses = FALSE, #
hist.col = "lightgray",#
lty = 1, #
pch = 1,#
lwd = 1, #
method = "pearson", #
cex = 2, #
col = "darkred", #
cex.labels = 1,font.labels = 2,#
gap =1.2, #
las = 1,#
scale = TRUE,#
digits = 3,#
main = "Housekeeping mRNAs"#
#
)#
}#
dev.off()
rain[,1:4]
rain$house <- mean(house)
rain$house <- as.data.frame.mean(house)
rain$house <- as.data.frame(mean(house))
table(rain$house, rain$sample)
table(rain$house)
rain$house)
rain$house <- as.data.frame(rowSums(house))
rain$house <- as.data.frame(rowMeans(house))
rain$house
rain <- rainall#
head(rain)#
colnames(rain)#
#
colnames(rain) <- c("Primer","629","731","1314","1700","2572","2741","2858","2910","2969","3544","3937","4428","4678","5485","7121","8239","filename" )#
rain <- rain[,-ncol(rain)]  #
summary(rain)#
nrow(rain)#
nrow(is.na(rain))#
nrow(rain) == nrow(is.na(rain))#
nrow(rain)#
length(complete.cases(rain))#
nrow(rain) == length(complete.cases(rain))#
nrow(rain)#
rain[duplicated(rain[,"Primer"]),]#
rain <- rain[-144,]#
#
summary(rain)#
rain.wide <- na.omit(rain)#
rain.wide <- drop.levels(rain)#
rownames(rain.wide) <- rain.wide$Primer#
rownames(rain.wide)#
head(rain.wide)#
summary(rain.wide)#
colnames(rain.wide)#
par(mfrow = c(1,1))#
par(bty = "n")#
par(cex=1.8)#
#
mean <- rowMeans(rain.wide[,2:ncol(rain.wide)], na.rm = TRUE)#
plot(density(mean), main = "", col = "red", lwd = 2)#
par(new = FALSE)#
colnames(rain.wide)#
rain.wide$mean <- rowMeans(rain.wide[,2:ncol(rain.wide)])#
rain.wide[rain.wide$mean>=45,]#
rain.wide <- subset(rain.wide,rain.wide$mean<=45)#
rain.wide <- rain.wide[,-ncol(rain.wide)]#
colnames(rain.wide)#
png(file = "PrimerPerformance.png", units = "in", width = 10, height = 6, res = 300)#
{#
par(mfrow = c(1,2))#
par(cex=1.7)#
par(bty="l")#
plot(ecdf(apply( rain.wide[,c(2:2:ncol(rain.wide))] ,1, FUN = mean, na.rm = TRUE)), col = "darkblue", verticals = TRUE, do.points = FALSE, lwd = 2, main = "a.", xlab = "mean CT' / primer", ylab = "Culm. density", las = 1, xlim = c(20, 50))    #
histSpike(apply(rain.wide[,c(2:2:ncol(rain.wide))] ,1, FUN = mean, na.rm = TRUE), add=TRUE, col = "darkred", frac = 0.2, lwd = 4)#
#
abline(v = 21, lty =3, col = "darkgreen")#
text(25,0,".", col = "darkgreen")#
text(25,1.0,".", col = "darkgreen")#
par(cex=1.7)#
par(bty = "l")#
plot( #
apply(rain.wide[,c(2:ncol(rain.wide))],1, mean, na.rm = TRUE), #
apply(rain.wide[,c(2:ncol(rain.wide))],1, sd, na.rm = TRUE),#
pch = 16,#
cex=1,#
#
xlim = c(20, 50),#
col = "darkred",  #
lwd = 2, #
las = 1,#
main = "b.", #
ylab = "sd CT' / primer", #
xlab = "mean CT' / primer")#
#
abline(h = 2, lty =2, col = "lightgray")#
abline(h = 4, lty =2, col = "lightgray")#
abline(h = 6, lty =2, col = "lightgray")#
abline(h = 8, lty =2, col = "lightgray")#
}#
dev.off()#
head(rain.wide)#
colnames(rain.wide)#
GLOBAL.allnumericStart = 2#
#
rain.wide <- as.matrix(rain.wide[,GLOBAL.allnumericStart:ncol(rain.wide)])#
rain.wide <- t(rain.wide)#
head(rain.wide)#
rain <- as.data.frame(rain.wide)#
head(rain[,1:4])#
head(rain)#
colnames(rain)#
rain2 <- rain[,c("BACT_2","B2M_2","ACTIN_2")]#
#
rain2#
rownames(rain2)#
house <- as.matrix(rain2)#
splom(house, col = "darkred", pch =19, pscales=2, type=c("g","p"), main = "housekeeping genes")#
house#
rain <- rain[rain$sample != "4428",]
rain <- rainall#
head(rain)#
colnames(rain)#
#
colnames(rain) <- c("Primer","629","731","1314","1700","2572","2741","2858","2910","2969","3544","3937","4428","4678","5485","7121","8239","filename" )#
rain <- rain[,-ncol(rain)]  #
summary(rain)#
nrow(rain)#
nrow(is.na(rain))#
nrow(rain) == nrow(is.na(rain))#
nrow(rain)#
length(complete.cases(rain))#
nrow(rain) == length(complete.cases(rain))#
nrow(rain)#
rain[duplicated(rain[,"Primer"]),]#
rain <- rain[-144,]#
#
summary(rain)#
rain.wide <- na.omit(rain)#
rain.wide <- drop.levels(rain)#
rownames(rain.wide) <- rain.wide$Primer#
rownames(rain.wide)#
head(rain.wide)#
summary(rain.wide)#
colnames(rain.wide)#
par(mfrow = c(1,1))#
par(bty = "n")#
par(cex=1.8)#
#
mean <- rowMeans(rain.wide[,2:ncol(rain.wide)], na.rm = TRUE)#
plot(density(mean), main = "", col = "red", lwd = 2)#
par(new = FALSE)#
colnames(rain.wide)#
rain.wide$mean <- rowMeans(rain.wide[,2:ncol(rain.wide)])#
rain.wide[rain.wide$mean>=45,]#
rain.wide <- subset(rain.wide,rain.wide$mean<=45)#
rain.wide <- rain.wide[,-ncol(rain.wide)]#
colnames(rain.wide)#
png(file = "PrimerPerformance.png", units = "in", width = 10, height = 6, res = 300)#
{#
par(mfrow = c(1,2))#
par(cex=1.7)#
par(bty="l")#
plot(ecdf(apply( rain.wide[,c(2:2:ncol(rain.wide))] ,1, FUN = mean, na.rm = TRUE)), col = "darkblue", verticals = TRUE, do.points = FALSE, lwd = 2, main = "a.", xlab = "mean CT' / primer", ylab = "Culm. density", las = 1, xlim = c(20, 50))    #
histSpike(apply(rain.wide[,c(2:2:ncol(rain.wide))] ,1, FUN = mean, na.rm = TRUE), add=TRUE, col = "darkred", frac = 0.2, lwd = 4)#
#
abline(v = 21, lty =3, col = "darkgreen")#
text(25,0,".", col = "darkgreen")#
text(25,1.0,".", col = "darkgreen")#
par(cex=1.7)#
par(bty = "l")#
plot( #
apply(rain.wide[,c(2:ncol(rain.wide))],1, mean, na.rm = TRUE), #
apply(rain.wide[,c(2:ncol(rain.wide))],1, sd, na.rm = TRUE),#
pch = 16,#
cex=1,#
#
xlim = c(20, 50),#
col = "darkred",  #
lwd = 2, #
las = 1,#
main = "b.", #
ylab = "sd CT' / primer", #
xlab = "mean CT' / primer")#
#
abline(h = 2, lty =2, col = "lightgray")#
abline(h = 4, lty =2, col = "lightgray")#
abline(h = 6, lty =2, col = "lightgray")#
abline(h = 8, lty =2, col = "lightgray")#
}#
dev.off()#
head(rain.wide)#
colnames(rain.wide)#
GLOBAL.allnumericStart = 2#
#
rain.wide <- as.matrix(rain.wide[,GLOBAL.allnumericStart:ncol(rain.wide)])#
rain.wide <- t(rain.wide)#
head(rain.wide)#
rain <- as.data.frame(rain.wide)#
head(rain[,1:4])#
head(rain)#
colnames(rain)#
rain2 <- rain[,c("BACT_2","B2M_2","ACTIN_2")]#
#
rain2#
rownames(rain2)#
house <- as.matrix(rain2)#
splom(house, col = "darkred", pch =19, pscales=2, type=c("g","p"), main = "housekeeping genes")#
house#
rownames(house)
house$sample <- rownames(house)
head(rain)#
colnames(rain)#
rain2 <- rain[,c("BACT_2","B2M_2","ACTIN_2")]#
#
rain2#
rownames(rain2)
head(rain)#
colnames(rain)#
house <- rain[,c("BACT_2","B2M_2","ACTIN_2")]#
#
house
splom(house, col = "darkred", pch =19, pscales=2, type=c("g","p"), main = "housekeeping genes")
house$sample <-rownames(house)
house <- house[house$sample != "4428",]
rain$sample <- rownames(rain)
rain <- rain[rain$sample != "4428",]
rain <- rain[-1,]
rain <- rain[,-ncol(rain)]
rain
rain <- rainall#
head(rain)#
colnames(rain)#
#
colnames(rain) <- c("Primer","629","731","1314","1700","2572","2741","2858","2910","2969","3544","3937","4428","4678","5485","7121","8239","filename" )#
rain <- rain[,-ncol(rain)]  #
summary(rain)#
nrow(rain)#
nrow(is.na(rain))#
nrow(rain) == nrow(is.na(rain))#
nrow(rain)#
length(complete.cases(rain))#
nrow(rain) == length(complete.cases(rain))#
nrow(rain)#
rain[duplicated(rain[,"Primer"]),]#
rain <- rain[-144,]#
#
summary(rain)#
rain.wide <- na.omit(rain)#
rain.wide <- drop.levels(rain)#
rownames(rain.wide) <- rain.wide$Primer#
rownames(rain.wide)#
head(rain.wide)#
summary(rain.wide)#
colnames(rain.wide)#
par(mfrow = c(1,1))#
par(bty = "n")#
par(cex=1.8)#
#
mean <- rowMeans(rain.wide[,2:ncol(rain.wide)], na.rm = TRUE)#
plot(density(mean), main = "", col = "red", lwd = 2)#
par(new = FALSE)#
colnames(rain.wide)#
rain.wide$mean <- rowMeans(rain.wide[,2:ncol(rain.wide)])#
rain.wide[rain.wide$mean>=45,]#
rain.wide <- subset(rain.wide,rain.wide$mean<=45)#
rain.wide <- rain.wide[,-ncol(rain.wide)]#
colnames(rain.wide)#
png(file = "PrimerPerformance.png", units = "in", width = 10, height = 6, res = 300)#
{#
par(mfrow = c(1,2))#
par(cex=1.7)#
par(bty="l")#
plot(ecdf(apply( rain.wide[,c(2:2:ncol(rain.wide))] ,1, FUN = mean, na.rm = TRUE)), col = "darkblue", verticals = TRUE, do.points = FALSE, lwd = 2, main = "a.", xlab = "mean CT' / primer", ylab = "Culm. density", las = 1, xlim = c(20, 50))    #
histSpike(apply(rain.wide[,c(2:2:ncol(rain.wide))] ,1, FUN = mean, na.rm = TRUE), add=TRUE, col = "darkred", frac = 0.2, lwd = 4)#
#
abline(v = 21, lty =3, col = "darkgreen")#
text(25,0,".", col = "darkgreen")#
text(25,1.0,".", col = "darkgreen")#
par(cex=1.7)#
par(bty = "l")#
plot( #
apply(rain.wide[,c(2:ncol(rain.wide))],1, mean, na.rm = TRUE), #
apply(rain.wide[,c(2:ncol(rain.wide))],1, sd, na.rm = TRUE),#
pch = 16,#
cex=1,#
#
xlim = c(20, 50),#
col = "darkred",  #
lwd = 2, #
las = 1,#
main = "b.", #
ylab = "sd CT' / primer", #
xlab = "mean CT' / primer")#
#
abline(h = 2, lty =2, col = "lightgray")#
abline(h = 4, lty =2, col = "lightgray")#
abline(h = 6, lty =2, col = "lightgray")#
abline(h = 8, lty =2, col = "lightgray")#
}#
dev.off()#
head(rain.wide)#
colnames(rain.wide)#
GLOBAL.allnumericStart = 2#
#
rain.wide <- as.matrix(rain.wide[,GLOBAL.allnumericStart:ncol(rain.wide)])#
rain.wide <- t(rain.wide)#
head(rain.wide)#
rain <- as.data.frame(rain.wide)#
head(rain[,1:4])#
head(rain)#
colnames(rain)#
house <- rain[,c("BACT_2","B2M_2","ACTIN_2")]#
splom(house, col = "darkred", pch =19, pscales=2, type=c("g","p"), main = "housekeeping genes")#
#
house$sample <-rownames(house)#
house#
house <- house[house$sample != "4428",]#
#
rain$sample <- rownames(rain)#
rain <- rain[rain$sample != "4428",]#
rain <- rain[,-ncol(rain)]#
#
house <- as.matrix(house)
house <- as.matrix(house[,-ncol(house)])
house <- as.matrix(as.numeric(house[,-ncol(house)]))
head(rain)#
colnames(rain)#
house <- rain[,c("BACT_2","B2M_2","ACTIN_2")]#
splom(house, col = "darkred", pch =19, pscales=2, type=c("g","p"), main = "housekeeping genes")#
#
house$sample <-rownames(house)#
house#
house <- house[house$sample != "4428",]#
#
rain$sample <- rownames(rain)#
rain <- rain[rain$sample != "4428",]#
rain <- rain[,-ncol(rain)]#
#
house <- as.matrix(house[,-ncol(house)])
pairs.panels (house, #
lm = TRUE, #
ellipses = FALSE, #
hist.col = "lightgray",#
lty = 1, #
pch = 1,#
lwd = 1, #
method = "pearson", #
cex = 2, #
col = "darkred", #
cex.labels = 1,font.labels = 2,#
gap =1.2, #
las = 1,#
scale = TRUE,#
digits = 3,#
main = "Housekeeping mRNAs"#
#
)
rain <- rainall#
head(rain)#
colnames(rain)#
#
colnames(rain) <- c("Primer","629","731","1314","1700","2572","2741","2858","2910","2969","3544","3937","4428","4678","5485","7121","8239","filename" )#
rain <- rain[,-ncol(rain)]  #
summary(rain)#
nrow(rain)#
nrow(is.na(rain))#
nrow(rain) == nrow(is.na(rain))#
nrow(rain)#
length(complete.cases(rain))#
nrow(rain) == length(complete.cases(rain))#
nrow(rain)#
rain[duplicated(rain[,"Primer"]),]#
rain <- rain[-144,]#
#
summary(rain)#
rain.wide <- na.omit(rain)#
rain.wide <- drop.levels(rain)#
rownames(rain.wide) <- rain.wide$Primer#
rownames(rain.wide)#
head(rain.wide)#
summary(rain.wide)#
colnames(rain.wide)#
par(mfrow = c(1,1))#
par(bty = "n")#
par(cex=1.8)#
#
mean <- rowMeans(rain.wide[,2:ncol(rain.wide)], na.rm = TRUE)#
plot(density(mean), main = "", col = "red", lwd = 2)#
par(new = FALSE)#
colnames(rain.wide)#
rain.wide$mean <- rowMeans(rain.wide[,2:ncol(rain.wide)])#
rain.wide[rain.wide$mean>=45,]#
rain.wide <- subset(rain.wide,rain.wide$mean<=45)#
rain.wide <- rain.wide[,-ncol(rain.wide)]#
colnames(rain.wide)#
png(file = "PrimerPerformance.png", units = "in", width = 10, height = 6, res = 300)#
{#
par(mfrow = c(1,2))#
par(cex=1.7)#
par(bty="l")#
plot(ecdf(apply( rain.wide[,c(2:2:ncol(rain.wide))] ,1, FUN = mean, na.rm = TRUE)), col = "darkblue", verticals = TRUE, do.points = FALSE, lwd = 2, main = "a.", xlab = "mean CT' / primer", ylab = "Culm. density", las = 1, xlim = c(20, 50))    #
histSpike(apply(rain.wide[,c(2:2:ncol(rain.wide))] ,1, FUN = mean, na.rm = TRUE), add=TRUE, col = "darkred", frac = 0.2, lwd = 4)#
#
abline(v = 21, lty =3, col = "darkgreen")#
text(25,0,".", col = "darkgreen")#
text(25,1.0,".", col = "darkgreen")#
par(cex=1.7)#
par(bty = "l")#
plot( #
apply(rain.wide[,c(2:ncol(rain.wide))],1, mean, na.rm = TRUE), #
apply(rain.wide[,c(2:ncol(rain.wide))],1, sd, na.rm = TRUE),#
pch = 16,#
cex=1,#
#
xlim = c(20, 50),#
col = "darkred",  #
lwd = 2, #
las = 1,#
main = "b.", #
ylab = "sd CT' / primer", #
xlab = "mean CT' / primer")#
#
abline(h = 2, lty =2, col = "lightgray")#
abline(h = 4, lty =2, col = "lightgray")#
abline(h = 6, lty =2, col = "lightgray")#
abline(h = 8, lty =2, col = "lightgray")#
}#
dev.off()#
head(rain.wide)#
colnames(rain.wide)#
GLOBAL.allnumericStart = 2#
#
rain.wide <- as.matrix(rain.wide[,GLOBAL.allnumericStart:ncol(rain.wide)])#
rain.wide <- t(rain.wide)#
head(rain.wide)#
rain <- as.data.frame(rain.wide)#
head(rain[,1:4])#
head(rain)#
colnames(rain)#
house <- rain[,c("BACT_2","B2M_2","ACTIN_2")]#
splom(house, col = "darkred", pch =19, pscales=2, type=c("g","p"), main = "housekeeping genes")#
#
house$sample <-rownames(house)#
house#
house <- house[house$sample != "4428",]#
#
rain$sample <- rownames(rain)#
rain <- rain[rain$sample != "4428",]#
rain <- rain[,-ncol(rain)]#
#
house <- as.matrix(house[,-ncol(house)])#
house
png(file = "HousekeepingGenes.png", units = "in", width = 8, height = 8, res = 300)#
{#
pairs.panels (house, #
lm = TRUE, #
ellipses = FALSE, #
hist.col = "lightgray",#
lty = 1, #
pch = 1,#
lwd = 1, #
method = "pearson", #
cex = 2, #
col = "darkred", #
cex.labels = 1,font.labels = 2,#
gap =1.2, #
las = 1,#
scale = TRUE,#
digits = 3,#
main = "Housekeeping mRNAs"#
#
)#
}#
dev.off()
house.cor <- cor(house,use="complete.obs",method="pearson")#
cor.plot(house.cor, main = "Housekeeping genes", zlim = c(0.8,1), cex.axis = 1.0, n = 32)#
house.cor <- mat.sort(house.cor)#
head(house.cor)#
cor.plot(house.cor, main = "Housekeeping Genes", zlim = c(0.5,1), cex.axis = 1.0, n = 32)#
house
rain <- rainall#
head(rain)#
colnames(rain)#
#
colnames(rain) <- c("Primer","629","731","1314","1700","2572","2741","2858","2910","2969","3544","3937","4428","4678","5485","7121","8239","filename" )#
rain <- rain[,-ncol(rain)]  #
summary(rain)#
nrow(rain)#
nrow(is.na(rain))#
nrow(rain) == nrow(is.na(rain))#
nrow(rain)#
length(complete.cases(rain))#
nrow(rain) == length(complete.cases(rain))#
nrow(rain)#
rain[duplicated(rain[,"Primer"]),]#
rain <- rain[-144,]#
#
summary(rain)#
rain.wide <- na.omit(rain)#
rain.wide <- drop.levels(rain)#
rownames(rain.wide) <- rain.wide$Primer#
rownames(rain.wide)#
head(rain.wide)#
summary(rain.wide)#
colnames(rain.wide)#
par(mfrow = c(1,1))#
par(bty = "n")#
par(cex=1.8)#
#
mean <- rowMeans(rain.wide[,2:ncol(rain.wide)], na.rm = TRUE)#
plot(density(mean), main = "", col = "red", lwd = 2)#
par(new = FALSE)#
colnames(rain.wide)#
rain.wide$mean <- rowMeans(rain.wide[,2:ncol(rain.wide)])#
rain.wide[rain.wide$mean>=45,]#
rain.wide <- subset(rain.wide,rain.wide$mean<=45)#
rain.wide <- rain.wide[,-ncol(rain.wide)]#
colnames(rain.wide)#
png(file = "PrimerPerformance.png", units = "in", width = 10, height = 6, res = 300)#
{#
par(mfrow = c(1,2))#
par(cex=1.7)#
par(bty="l")#
plot(ecdf(apply( rain.wide[,c(2:2:ncol(rain.wide))] ,1, FUN = mean, na.rm = TRUE)), col = "darkblue", verticals = TRUE, do.points = FALSE, lwd = 2, main = "a.", xlab = "mean CT' / primer", ylab = "Culm. density", las = 1, xlim = c(20, 50))    #
histSpike(apply(rain.wide[,c(2:2:ncol(rain.wide))] ,1, FUN = mean, na.rm = TRUE), add=TRUE, col = "darkred", frac = 0.2, lwd = 4)#
#
abline(v = 21, lty =3, col = "darkgreen")#
text(25,0,".", col = "darkgreen")#
text(25,1.0,".", col = "darkgreen")#
par(cex=1.7)#
par(bty = "l")#
plot( #
apply(rain.wide[,c(2:ncol(rain.wide))],1, mean, na.rm = TRUE), #
apply(rain.wide[,c(2:ncol(rain.wide))],1, sd, na.rm = TRUE),#
pch = 16,#
cex=1,#
#
xlim = c(20, 50),#
col = "darkred",  #
lwd = 2, #
las = 1,#
main = "b.", #
ylab = "sd CT' / primer", #
xlab = "mean CT' / primer")#
#
abline(h = 2, lty =2, col = "lightgray")#
abline(h = 4, lty =2, col = "lightgray")#
abline(h = 6, lty =2, col = "lightgray")#
abline(h = 8, lty =2, col = "lightgray")#
}#
dev.off()#
head(rain.wide)#
colnames(rain.wide)#
GLOBAL.allnumericStart = 2#
#
rain.wide <- as.matrix(rain.wide[,GLOBAL.allnumericStart:ncol(rain.wide)])#
rain.wide <- t(rain.wide)#
head(rain.wide)#
rain <- as.data.frame(rain.wide)#
head(rain[,1:4])#
rain2 <- rain#
head(rain)#
colnames(rain)#
house <- rain[,c("BACT_2","B2M_2","ACTIN_2")]#
splom(house, col = "darkred", pch =19, pscales=2, type=c("g","p"), main = "housekeeping genes")#
#
house$sample <-rownames(house)#
house#
house <- house[house$sample != "4428",]#
#
rain2$sample <- rownames(rain2)#
nrow(rain2)#
rain2 <- rain2[rain2$sample != "4428",]#
rain2 <- rain2[,-ncol(rain2)]#
nrow(rain2)#
#
house <- as.matrix(house[,-ncol(house)])#
house
png(file = "HousekeepingGenes.png", units = "in", width = 8, height = 8, res = 300)#
{#
pairs.panels (house, #
lm = TRUE, #
ellipses = FALSE, #
hist.col = "lightgray",#
lty = 1, #
pch = 1,#
lwd = 1, #
method = "pearson", #
cex = 2, #
col = "darkred", #
cex.labels = 1,font.labels = 2,#
gap =1.2, #
las = 1,#
scale = TRUE,#
digits = 3,#
main = "Housekeeping mRNAs"#
#
)#
}#
dev.off()#
house.cor <- cor(house,use="complete.obs",method="pearson")#
cor.plot(house.cor, main = "Housekeeping genes", zlim = c(0.8,1), cex.axis = 1.0, n = 32)#
house.cor <- mat.sort(house.cor)#
head(house.cor)#
cor.plot(house.cor, main = "Housekeeping Genes", zlim = c(0.5,1), cex.axis = 1.0, n = 32)#
house
house <- as.matrix(rain2[,c("BACT_2","B2M_2","ACTIN_2")])#
house#
geo <- as.data.frame(apply(house, 1, geometric.mean))#
colnames(geo) <- c("house")#
geo$name <- rownames(house)#
head(geo)#
geo
house <- as.matrix(rain2[,c("BACT_2","B2M_2","ACTIN_2")])
house
geo <- as.data.frame(apply(house, 1, geometric.mean))
colnames(geo) <- c("house")
geo$name <- rownames(house)
head(geo)
geo
nrow(rain)
nrow(rain2)
rain <- rain2
house <- as.matrix(rain[,c("BACT_2","B2M_2","ACTIN_2")])#
house#
geo <- as.data.frame(apply(house, 1, geometric.mean))#
colnames(geo) <- c("house")#
geo$name <- rownames(house)#
geo
head(rain)#
rain$name <- as.factor(rownames(rain))#
rain <- cbind(geo,rain)#
rain <- rain[,-ncol(rain)]#
rain$name <- as.factor(rain$name)#
colnames(rain)#
GLOBAL.allnumericStart <- GLOBAL.allnumericStart + 1#
GLOBAL.allnumericStart#
head(rain[,1:4])
for (i in GLOBAL.allnumericStart:ncol(rain))#
	{#
	rain[,i] <- 		rain[,"house"] - rain[,i]#
	}#
#
summary(rain)#
write.table(rain,file = "dCT.txt", sep = "\t",row.names = FALSE)#
rownames(rain)#
png(file = "AlteredGenesBasedonSDofdCT'.png", units = "in", width = 6, height = 6, res = 300)#
{#
par(mfrow = c(1,1))#
par(cex = 1.6)#
par(bty = "l")#
#
plot(ecdf(apply(rain[,GLOBAL.allnumericStart:ncol(rain)],2, sd)), col = "darkred", verticals = TRUE, do.points = FALSE, lwd = 2, main = "", xlab = "s.d. of dCT'", ylab = "Culm. Density", xlim = c(0,10), lty =1, cex = 2, las = 1)    #
#
histSpike(apply(rain[,GLOBAL.allnumericStart:ncol(rain)],2, sd), add=TRUE, col = "darkgray", frac = 0.3, lwd = 5)#
}#
dev.off()#
#
head(rain[,1:4])
head(rain)#
subset(rain[,GLOBAL.allnumericStart:ncol(rain)], apply(rain[,GLOBAL.allnumericStart:ncol(rain)],1, sd) < 1)#
rain.2 <- subset(rain[,GLOBAL.allnumericStart:ncol(rain)], apply(rain[,GLOBAL.allnumericStart:ncol(rain)],1, sd) > 1)#
ncol(rain)#
ncol(rain.2)#
head(rain.2)#
#
png(file = "SD filter.png", units = "in", width = 8, height = 8, res = 600)#
{#
par(mfrow = c(1,2))#
par(cex = 1.5)#
plot(ecdf(apply(rain[,GLOBAL.allnumericStart:ncol(rain)],2, sd)), col = "darkblue", verticals = TRUE, do.points = FALSE, lwd = 2, main = ncol(rain), xlab = "sd CT' ")    #
histSpike(apply(rain[,GLOBAL.allnumericStart:ncol(rain)],2, sd), add=TRUE, col = "darkred", frac = 0.2, lwd = 3)#
#
plot(ecdf(apply(rain.2[,GLOBAL.allnumericStart:ncol(rain.2)],2, sd)), col = "darkblue", verticals = TRUE, do.points = FALSE, lwd = 2, main = ncol(rain.2), xlab = "CT' ")    #
histSpike(apply(rain.2[,GLOBAL.allnumericStart:ncol(rain.2)],2, sd), add=TRUE, col = "darkred", frac = 0.2, lwd = 3)#
}#
dev.off()#
rain <- rain.2#
GLOBAL.allnumericStart <- 1
rain <- rain.2
GLOBAL.allnumericStart <- 1
rain <- rainall#
head(rain)#
colnames(rain)#
#
colnames(rain) <- c("Primer","629","731","1314","1700","2572","2741","2858","2910","2969","3544","3937","4428","4678","5485","7121","8239","filename" )#
rain <- rain[,-ncol(rain)]  #
summary(rain)#
nrow(rain)#
nrow(is.na(rain))#
nrow(rain) == nrow(is.na(rain))#
nrow(rain)#
length(complete.cases(rain))#
nrow(rain) == length(complete.cases(rain))#
nrow(rain)#
rain[duplicated(rain[,"Primer"]),]#
rain <- rain[-144,]#
#
summary(rain)#
rain.wide <- na.omit(rain)#
rain.wide <- drop.levels(rain)#
rownames(rain.wide) <- rain.wide$Primer#
rownames(rain.wide)#
head(rain.wide)#
summary(rain.wide)#
colnames(rain.wide)#
par(mfrow = c(1,1))#
par(bty = "n")#
par(cex=1.8)#
#
mean <- rowMeans(rain.wide[,2:ncol(rain.wide)], na.rm = TRUE)#
plot(density(mean), main = "", col = "red", lwd = 2)#
par(new = FALSE)#
colnames(rain.wide)#
rain.wide$mean <- rowMeans(rain.wide[,2:ncol(rain.wide)])#
rain.wide[rain.wide$mean>=45,]#
rain.wide <- subset(rain.wide,rain.wide$mean<=45)#
rain.wide <- rain.wide[,-ncol(rain.wide)]#
colnames(rain.wide)#
png(file = "PrimerPerformance.png", units = "in", width = 10, height = 6, res = 300)#
{#
par(mfrow = c(1,2))#
par(cex=1.7)#
par(bty="l")#
plot(ecdf(apply( rain.wide[,c(2:2:ncol(rain.wide))] ,1, FUN = mean, na.rm = TRUE)), col = "darkblue", verticals = TRUE, do.points = FALSE, lwd = 2, main = "a.", xlab = "mean CT' / primer", ylab = "Culm. density", las = 1, xlim = c(20, 50))    #
histSpike(apply(rain.wide[,c(2:2:ncol(rain.wide))] ,1, FUN = mean, na.rm = TRUE), add=TRUE, col = "darkred", frac = 0.2, lwd = 4)#
#
abline(v = 21, lty =3, col = "darkgreen")#
text(25,0,".", col = "darkgreen")#
text(25,1.0,".", col = "darkgreen")#
par(cex=1.7)#
par(bty = "l")#
plot( #
apply(rain.wide[,c(2:ncol(rain.wide))],1, mean, na.rm = TRUE), #
apply(rain.wide[,c(2:ncol(rain.wide))],1, sd, na.rm = TRUE),#
pch = 16,#
cex=1,#
#
xlim = c(20, 50),#
col = "darkred",  #
lwd = 2, #
las = 1,#
main = "b.", #
ylab = "sd CT' / primer", #
xlab = "mean CT' / primer")#
#
abline(h = 2, lty =2, col = "lightgray")#
abline(h = 4, lty =2, col = "lightgray")#
abline(h = 6, lty =2, col = "lightgray")#
abline(h = 8, lty =2, col = "lightgray")#
}#
dev.off()#
head(rain.wide)#
colnames(rain.wide)#
GLOBAL.allnumericStart = 2#
#
rain.wide <- as.matrix(rain.wide[,GLOBAL.allnumericStart:ncol(rain.wide)])#
rain.wide <- t(rain.wide)#
head(rain.wide)#
rain <- as.data.frame(rain.wide)#
head(rain[,1:4])#
rain2 <- rain#
head(rain)#
colnames(rain)#
house <- rain[,c("BACT_2","B2M_2","ACTIN_2")]#
splom(house, col = "darkred", pch =19, pscales=2, type=c("g","p"), main = "housekeeping genes")#
#
house$sample <-rownames(house)#
house#
house <- house[house$sample != "4428",]#
#
rain2$sample <- rownames(rain2)#
#
rain2 <- rain2[rain2$sample != "4428",]#
rain2 <- rain2[,-ncol(rain2)]#
house <- as.matrix(house[,-ncol(house)])#
house#
#
nrow(rain)#
nrow(rain2)#
rain <- rain2#
png(file = "HousekeepingGenes.png", units = "in", width = 8, height = 8, res = 300)#
{#
pairs.panels (house, #
lm = TRUE, #
ellipses = FALSE, #
hist.col = "lightgray",#
lty = 1, #
pch = 1,#
lwd = 1, #
method = "pearson", #
cex = 2, #
col = "darkred", #
cex.labels = 1,font.labels = 2,#
gap =1.2, #
las = 1,#
scale = TRUE,#
digits = 3,#
main = "Housekeeping mRNAs"#
#
)#
}#
dev.off()#
house.cor <- cor(house,use="complete.obs",method="pearson")#
cor.plot(house.cor, main = "Housekeeping genes", zlim = c(0.8,1), cex.axis = 1.0, n = 32)#
house.cor <- mat.sort(house.cor)#
head(house.cor)#
cor.plot(house.cor, main = "Housekeeping Genes", zlim = c(0.5,1), cex.axis = 1.0, n = 32)#
house#
house <- as.matrix(rain[,c("BACT_2","B2M_2","ACTIN_2")])#
house#
geo <- as.data.frame(apply(house, 1, geometric.mean))#
colnames(geo) <- c("house")#
geo$name <- rownames(house)#
geo#
#
head(rain)#
rain$name <- as.factor(rownames(rain))#
rain <- cbind(geo,rain)#
rain <- rain[,-ncol(rain)]#
rain$name <- as.factor(rain$name)#
colnames(rain)#
GLOBAL.allnumericStart <- GLOBAL.allnumericStart + 1#
GLOBAL.allnumericStart#
head(rain[,1:4])#
for (i in GLOBAL.allnumericStart:ncol(rain))#
	{#
	rain[,i] <- 		rain[,"house"] - rain[,i]#
	}#
#
summary(rain)#
write.table(rain,file = "dCT.txt", sep = "\t",row.names = FALSE)#
rownames(rain)#
png(file = "AlteredGenesBasedonSDofdCT'.png", units = "in", width = 6, height = 6, res = 300)#
{#
par(mfrow = c(1,1))#
par(cex = 1.6)#
par(bty = "l")#
#
plot(ecdf(apply(rain[,GLOBAL.allnumericStart:ncol(rain)],2, sd)), col = "darkred", verticals = TRUE, do.points = FALSE, lwd = 2, main = "", xlab = "s.d. of dCT'", ylab = "Culm. Density", xlim = c(0,10), lty =1, cex = 2, las = 1)    #
#
histSpike(apply(rain[,GLOBAL.allnumericStart:ncol(rain)],2, sd), add=TRUE, col = "darkgray", frac = 0.3, lwd = 5)#
}#
dev.off()#
#
head(rain[,1:4])#
head(rain)#
subset(rain[,GLOBAL.allnumericStart:ncol(rain)], apply(rain[,GLOBAL.allnumericStart:ncol(rain)],1, sd) < 1)#
rain.2 <- subset(rain[,GLOBAL.allnumericStart:ncol(rain)], apply(rain[,GLOBAL.allnumericStart:ncol(rain)],1, sd) > 1)#
ncol(rain)#
ncol(rain.2)#
head(rain.2)#
#
png(file = "SD filter.png", units = "in", width = 8, height = 8, res = 600)#
{#
par(mfrow = c(1,2))#
par(cex = 1.5)#
plot(ecdf(apply(rain[,GLOBAL.allnumericStart:ncol(rain)],2, sd)), col = "darkblue", verticals = TRUE, do.points = FALSE, lwd = 2, main = ncol(rain), xlab = "sd CT' ")    #
histSpike(apply(rain[,GLOBAL.allnumericStart:ncol(rain)],2, sd), add=TRUE, col = "darkred", frac = 0.2, lwd = 3)#
#
plot(ecdf(apply(rain.2[,GLOBAL.allnumericStart:ncol(rain.2)],2, sd)), col = "darkblue", verticals = TRUE, do.points = FALSE, lwd = 2, main = ncol(rain.2), xlab = "CT' ")    #
histSpike(apply(rain.2[,GLOBAL.allnumericStart:ncol(rain.2)],2, sd), add=TRUE, col = "darkred", frac = 0.2, lwd = 3)#
}#
dev.off()#
rain <- rain.2#
GLOBAL.allnumericStart <- 1#
colnames(rain)#
rownames(rain)#
GLOBAL.allnumericStart#
head(rain[,1:5])
rainCluster	<- melt(rain)#
rainCluster <- na.omit(rainCluster)#
rainCluster <- drop.levels(rainCluster)#
colnames(rainCluster) <- c("Primer","dCT")#
summary(rainCluster)#
nrow(rainCluster)#
head(rainCluster)#
IQR(rainCluster$dCT, na.rm = TRUE)#
fivenum(rainCluster$dCT, na.rm = TRUE)#
shapiro.test(rainCluster$dCT)#
png(file = "qqPlot Of All dCT.png", units = "in", width = 8, height = 8, res = 300)#
{#
par(mfrow = c(1,1))#
par(cex = 1.8)#
par(bty = "o")#
qqnorm(rainCluster[,"dCT"], #
pch = 19,#
cex = 0.5, #
las = 1,#
col = "darkred",#
main = "Samples")#
qqline(rainCluster[,"dCT"], col = "darkblue", lwd = 2, lty = 3)#
histSpike(rainCluster[,"dCT"], add=TRUE, col = "darkgray", frac = 0.5, lwd = 5, side =2)#
#
abline(h = 0, lty =2, col = "lightgray")#
abline(v = 0, lty =2, col = "lightgray")#
}#
dev.off()
par(mfrow = c(1,1))#
par(cex = 1.8)#
par(bty = "o")#
qqnorm(rainCluster[,"dCT"], #
pch = 19,#
cex = 0.5, #
las = 1,#
col = "darkred",#
main = "Samples")#
qqline(rainCluster[,"dCT"], col = "darkblue", lwd = 2, lty = 3)#
histSpike(rainCluster[,"dCT"], add=TRUE, col = "darkgray", frac = 0.5, lwd = 5, side =2)#
#
abline(h = 0, lty =2, col = "lightgray")#
abline(v = 0, lty =2, col = "lightgray")
summary(rain[,1:4])#
GLOBAL.allnumericStart#
rownames(rain)
colnames(rain)
rain[,53:55]
rain <- rain[,-c(53:55)]
rownames(rain)
try2m <- as.matrix(rain[,GLOBAL.allnumericStart:ncol(rain)]) #
nrow(try2m)#
nrow(try2m[!complete.cases(try2m),])#
rownames(try2m)#
head(try2m[,1:5])#
nrow(try2m)
rgb.palette <- colorRampPalette(c("white", "orange", "red"), space = "rgb", bias = 1)#
heatmap.plus(try2m, na.rm = T, scale = "none", col = rgb.palette(25), hclustfun=function(m) hclust(m, method="ward"), distfun = function(x) dist(x, method = "manhattan"), margins = c(10,15), Colv = T, Rowv = T)
png(file = "heatmap dCT' orange.png", units = "in", width = 21, height = 7, res = 300)#
{#
rgb.palette <- colorRampPalette(c("white", "orange", "red"), space = "rgb", bias = 1)#
heatmap.plus(try2m, na.rm = T, scale = "none", col = rgb.palette(25), hclustfun=function(m) hclust(m, method="ward"), distfun = function(x) dist(x, method = "manhattan"), margins = c(10,15), Colv = T, Rowv = T)#
}#
dev.off()
heatmap.plus(try2m, na.rm = T, scale = "none", col = rgb.palette(25), hclustfun=function(m) hclust(m, method="ward.D"), distfun = function(x) dist(x, method = "manhattan"), margins = c(10,15), Colv = T, Rowv = T)
png(file = "heatmap dCT' alternativeColor.png", units = "in", width = 21, height = 7, res = 300)#
{#
brewer.palette <- colorRampPalette(rev(brewer.pal(11, "RdYlBu")),space = "rgb", bias = 1.2, interpolate = "linear")#
heatmap.plus(try2m, na.rm = T, scale = "none", col = brewer.palette (55), hclustfun=function(m) hclust(m, method="ward.d"), distfun = function(x) dist(x, method = "manhattan"), margins = c(10,15), Colv = T, Rowv = T, main = "dCT", xlab = "CDS", ylab = "samples")#
}#
dev.off()
png(file = "heatmap dCT' alternativeColor.png", units = "in", width = 21, height = 7, res = 300)#
{#
brewer.palette <- colorRampPalette(rev(brewer.pal(11, "RdYlBu")),space = "rgb", bias = 1.2, interpolate = "linear")#
heatmap.plus(try2m, na.rm = T, scale = "none", col = brewer.palette (55), hclustfun=function(m) hclust(m, method="ward.D"), distfun = function(x) dist(x, method = "manhattan"), margins = c(10,15), Colv = T, Rowv = T, main = "dCT", xlab = "CDS", ylab = "samples")#
}#
dev.off()
png(file = "heatmap dCT'alternativeColor scaled by sample.png", units = "in", width = 21, height = 7, res = 300)#
{#
brewer.palette <- colorRampPalette(rev(brewer.pal(11, "RdYlBu")),space = "rgb", bias = 1, interpolate = "linear")#
heatmap.plus(try2m, na.rm = T, scale = "row", col = brewer.palette (55), #
hclustfun=function(m) hclust(m, method="ward.D"), #
distfun = function(x) dist(x, method = "manhattan"), #
margins = c(12,24), #
Colv = T, Rowv = T, #
cexRow = 1, cexCol = 0.5,#
main = "dCT' scaled by sample", xlab = "CDS", ylab = "samples")#
}#
dev.off()
GLOBAL.tryDCT <- try2m#
summary(GLOBAL.tryDCT)#
head(GLOBAL.tryDCT)
experimentByprimer <- try2m#
head(experimentByprimer)#
experimentByprimer  <- scale(experimentByprimer , center = TRUE, scale = FALSE)#
head(experimentByprimer)#
#
primer.cor <- cor(experimentByprimer, use="complete.obs",method="pearson")#
head(primer.cor)#
cor.plot(primer.cor, main = "all genes", zlim = c(0.5,1), cex.axis = 0.8, n = 12)#
primer.cor <- mat.sort(primer.cor)#
head(primer.cor)#
cor.plot(primer.cor, main = "dCT", zlim = c(-1,1), cex.axis = 0.8, n = 12)
head(experimentByprimer[,1:4])#
png(file = "heatmap dCT' centered By Primer.png", units = "in", width = 21, height = 7, res = 300)#
{#
brewer.palette <- colorRampPalette(rev(brewer.pal(11, "RdYlBu")),space = "rgb", bias = 0.8, interpolate = "linear")#
heatmap.plus(experimentByprimer, na.rm = T, scale = "none", col = brewer.palette (55),#
hclustfun=function(m) hclust(m, method="ward.D"), #
distfun = function(x) dist(x, method = "manhattan"), #
margins = c(12,24), #
Colv = T, Rowv = T, #
cexRow = 1, cexCol = 0.5,#
main = "dCT' centered by primer", xlab = "primer", ylab = "samples")#
}#
dev.off()
head(experimentByprimer)#
png(file = "heatmap dCT' centered By Primer purple.png", units = "in", width = 21, height = 7, res = 300)#
{#
brewer.palette <- colorRampPalette(rev(brewer.pal(11, "PuOr")),space = "rgb", bias = 0.8, interpolate = "spline")#
heatmap.plus(experimentByprimer, na.rm = T, scale = "none", col = brewer.palette (55),#
hclustfun=function(m) hclust(m, method="ward.D"), #
distfun = function(x) dist(x, method = "manhattan"), #
margins = c(12,24), #
Colv = T, Rowv = T, #
cexRow = 1, cexCol = 0.5,#
main = "dCT centered by primer", xlab = "primer", ylab = "samples")#
}#
dev.off()
head(try2m)#
for.pca <- t(try2m)#
for.pca <- unique(for.pca)#
colnames(for.pca) <- rownames(try2m)#
rownames(for.pca) <- colnames(try2m)#
head(for.pca)#
#
mir.pca <- PCA(for.pca, scale.unit = T, ncp = 5, graph = F)#
par(mfrow = c(2,2))#
plot.PCA(mir.pca, cex=1.0, choix ="ind", axes = c(1,2), title = "Samples", col.ind = "darkred")#
plot.PCA(mir.pca, cex=1.0, choix ="ind", axes = c(2,3), title = "Samples", col.ind = "darkred")#
plot.PCA(mir.pca, cex=1.0, choix ="ind", axes = c(1,3), title = "Samples", col.ind = "darkred")#
#
dimdesc(mir.pca)#
barplot(mir.pca$eig[,1], main = "Eigenvalues", names.arg = paste ("Dim", 1:nrow(mir.pca$eig), sep = ""))
mir.pca <- PCA(for.pca, scale.unit = F, ncp = Inf, graph = F)#
#
png(file = "PCA of samples.png", units = "in", width = 8, height = 8, res = 300)#
{#
par(mfrow = c(2,2))#
par(cex = 1.2)#
plot.PCA(mir.pca, cex=0.5, choix ="ind", axes = c(1,2), title = "Samples", col.ind = "darkblue")#
plot.PCA(mir.pca, cex=0.5, choix ="ind", axes = c(2,3), title = "Samples", col.ind = "darkblue")#
plot.PCA(mir.pca, cex=0.5, choix ="ind", axes = c(1,3), title = "Samples", col.ind = "darkblue")#
dimdesc(mir.pca)#
barplot(mir.pca$eig[,1], main = "Eigenvalues", names.arg = paste ("Dim", 1:nrow(mir.pca$eig), sep = ""), col = "darkgray", las = 2, cex.names = 0.5)#
}#
dev.off()
mir.hcpc <- HCPC(mir.pca)#
mir.hcpc$desc.var #
mir.hcpc$desc.axe#
print(mir.hcpc$desc.ind)
head(GLOBAL.tryDCT)#
#
waterfall <- t(GLOBAL.tryDCT)#
waterfall <- data.frame(waterfall)#
head(waterfall)
control <- waterfall[,"X8239"]
waterfall <- sweep(waterfall,1,control,FUN = "-")
waterfall <- waterfall[order(waterfall[,1], decreasing = F),]
colnames(waterfall)#
par(mfrow = c(1,1))#
par(cex=1.0)#
par(bty="n")#
barplot(1.8^waterfall[,1], #
main = "K1 deletion", #
pch = 19, #
col = "gray", #
#
names.arg = rownames(waterfall), #
ylab = "fold induction", #
xaxs = "r",yaxs = "r", #
xaxt ="s",#
las = 3,#
#
ylim = c(0,5)#
)#
abline(h = median(waterfall[,1]), lwd = 1, col = "gray", lty = 2)#
abline(h = (median(waterfall[,1])-sd(waterfall[,1])), lwd = 1, col = "gray", lty = 2)#
abline(h = (median(waterfall[,1])+sd(waterfall[,1])), lwd = 1, col = "gray", lty = 2)
head(waterfall)#
tail(waterfall)#
write.table(waterfall,file = "dCTordered.txt", sep = "\t")
library(gdata)#
library(reshape2)#
library(MASS)#
library(RColorBrewer)#
library(psych)#
library(FactoMineR)#
library(heatmap.plus)#
library(DMwR)#
library(Hmisc)#
library(vegan)#
#
library(xlsx)#
options(digits=3)#
setwd("/Users/dirk/DittmerSync/paper 2014 array Malawi Array/R Try1 heatmap n16")#
read.exceldata <- function(x)#
{#
	filnamelistlength <- length(x)#
	mir <- read.xlsx(x[1], sheetIndex=1)#
	mir$filename <- factor(x[1])#
	rain <- mir#
	print(nrow(rain))#
	if (filnamelistlength< 2) return (rain)#
	for (i in 2:filnamelistlength)#
	{#
	mir <- read.xlsx(x[i], sheetIndex=1)#
	mir$filename <- factor(x[i])#
	rain <- rbind(rain,mir)#
	print(nrow(rain))#
	}	#
	return (rain)#
}#
filenames <- c("a.xlsx","b.xlsx")#
rain <- read.exceldata(filenames)#
#
summary(rain)#
head(rain)#
table(rain$filename)
rainall <- rain#
write.table(rainall,file = "CompleteDataSet_CT.txt", sep = "\t", row.names = FALSE)#
rain <- rainall#
head(rain)#
colnames(rain)#
#
colnames(rain) <- c("Primer","629","731","1314","1700","2572","2741","2858","2910","2969","3544","3937","4428","4678","5485","7121","8239","filename" )#
rain <- rain[,-ncol(rain)]  #
summary(rain)#
nrow(rain)#
nrow(is.na(rain))#
nrow(rain) == nrow(is.na(rain))#
nrow(rain)#
length(complete.cases(rain))#
nrow(rain) == length(complete.cases(rain))#
nrow(rain)#
rain[duplicated(rain[,"Primer"]),]#
rain <- rain[-144,]#
#
summary(rain)#
rain.wide <- na.omit(rain)#
rain.wide <- drop.levels(rain)#
rownames(rain.wide) <- rain.wide$Primer#
rownames(rain.wide)#
head(rain.wide)#
summary(rain.wide)#
colnames(rain.wide)#
par(mfrow = c(1,1))#
par(bty = "n")#
par(cex=1.8)#
#
mean <- rowMeans(rain.wide[,2:ncol(rain.wide)], na.rm = TRUE)#
plot(density(mean), main = "", col = "red", lwd = 2)#
par(new = FALSE)#
colnames(rain.wide)#
rain.wide$mean <- rowMeans(rain.wide[,2:ncol(rain.wide)])#
rain.wide[rain.wide$mean>=45,]#
rain.wide <- subset(rain.wide,rain.wide$mean<=45)#
rain.wide <- rain.wide[,-ncol(rain.wide)]#
colnames(rain.wide)#
png(file = "PrimerPerformance.png", units = "in", width = 10, height = 6, res = 300)#
{#
par(mfrow = c(1,2))#
par(cex=1.7)#
par(bty="l")#
plot(ecdf(apply( rain.wide[,c(2:2:ncol(rain.wide))] ,1, FUN = mean, na.rm = TRUE)), col = "darkblue", verticals = TRUE, do.points = FALSE, lwd = 2, main = "a.", xlab = "mean CT' / primer", ylab = "Culm. density", las = 1, xlim = c(20, 50))    #
histSpike(apply(rain.wide[,c(2:2:ncol(rain.wide))] ,1, FUN = mean, na.rm = TRUE), add=TRUE, col = "darkred", frac = 0.2, lwd = 4)#
#
abline(v = 21, lty =3, col = "darkgreen")#
text(25,0,".", col = "darkgreen")#
text(25,1.0,".", col = "darkgreen")#
par(cex=1.7)#
par(bty = "l")#
plot( #
apply(rain.wide[,c(2:ncol(rain.wide))],1, mean, na.rm = TRUE), #
apply(rain.wide[,c(2:ncol(rain.wide))],1, sd, na.rm = TRUE),#
pch = 16,#
cex=1,#
#
xlim = c(20, 50),#
col = "darkred",  #
lwd = 2, #
las = 1,#
main = "b.", #
ylab = "sd CT' / primer", #
xlab = "mean CT' / primer")#
#
abline(h = 2, lty =2, col = "lightgray")#
abline(h = 4, lty =2, col = "lightgray")#
abline(h = 6, lty =2, col = "lightgray")#
abline(h = 8, lty =2, col = "lightgray")#
}#
dev.off()#
head(rain.wide)#
colnames(rain.wide)#
GLOBAL.allnumericStart = 2#
#
rain.wide <- as.matrix(rain.wide[,GLOBAL.allnumericStart:ncol(rain.wide)])#
rain.wide <- t(rain.wide)#
head(rain.wide)#
rain <- as.data.frame(rain.wide)#
head(rain[,1:4])
rain2 <- rain#
head(rain)#
colnames(rain)#
house <- rain[,c("BACT_2","B2M_2","ACTIN_2")]#
splom(house, col = "darkred", pch =19, pscales=2, type=c("g","p"), main = "housekeeping genes")#
#
house$sample <-rownames(house)#
house#
house <- house[house$sample != "4428",]#
#
rain2$sample <- rownames(rain2)#
#
rain2 <- rain2[rain2$sample != "4428",]#
rain2 <- rain2[,-ncol(rain2)]#
house <- as.matrix(house[,-ncol(house)])#
house#
#
nrow(rain)#
nrow(rain2)#
rain <- rain2#
png(file = "HousekeepingGenes.png", units = "in", width = 8, height = 8, res = 300)#
{#
pairs.panels (house, #
lm = TRUE, #
ellipses = FALSE, #
hist.col = "lightgray",#
lty = 1, #
pch = 1,#
lwd = 1, #
method = "pearson", #
cex = 2, #
col = "darkred", #
cex.labels = 1,font.labels = 2,#
gap =1.2, #
las = 1,#
scale = TRUE,#
digits = 3,#
main = "Housekeeping mRNAs"#
#
)#
}#
dev.off()#
house.cor <- cor(house,use="complete.obs",method="pearson")#
cor.plot(house.cor, main = "Housekeeping genes", zlim = c(0.8,1), cex.axis = 1.0, n = 32)#
house.cor <- mat.sort(house.cor)#
head(house.cor)#
cor.plot(house.cor, main = "Housekeeping Genes", zlim = c(0.5,1), cex.axis = 1.0, n = 32)#
house#
house <- as.matrix(rain[,c("BACT_2","B2M_2","ACTIN_2")])#
house#
geo <- as.data.frame(apply(house, 1, geometric.mean))#
colnames(geo) <- c("house")#
geo$name <- rownames(house)#
geo#
#
head(rain)#
rain$name <- as.factor(rownames(rain))#
rain <- cbind(geo,rain)#
rain <- rain[,-ncol(rain)]#
rain$name <- as.factor(rain$name)#
colnames(rain)#
GLOBAL.allnumericStart <- GLOBAL.allnumericStart + 1#
GLOBAL.allnumericStart#
head(rain[,1:4])#
for (i in GLOBAL.allnumericStart:ncol(rain))#
	{#
	rain[,i] <- 		rain[,"house"] - rain[,i]#
	}#
#
summary(rain)#
write.table(rain,file = "dCT.txt", sep = "\t",row.names = FALSE)#
rownames(rain)#
png(file = "AlteredGenesBasedonSDofdCT'.png", units = "in", width = 6, height = 6, res = 300)#
{#
par(mfrow = c(1,1))#
par(cex = 1.6)#
par(bty = "l")#
#
plot(ecdf(apply(rain[,GLOBAL.allnumericStart:ncol(rain)],2, sd)), col = "darkred", verticals = TRUE, do.points = FALSE, lwd = 2, main = "", xlab = "s.d. of dCT'", ylab = "Culm. Density", xlim = c(0,10), lty =1, cex = 2, las = 1)    #
#
histSpike(apply(rain[,GLOBAL.allnumericStart:ncol(rain)],2, sd), add=TRUE, col = "darkgray", frac = 0.3, lwd = 5)#
}#
dev.off()#
#
head(rain[,1:4])#
head(rain)#
subset(rain[,GLOBAL.allnumericStart:ncol(rain)], apply(rain[,GLOBAL.allnumericStart:ncol(rain)],1, sd) < 1)#
rain.2 <- subset(rain[,GLOBAL.allnumericStart:ncol(rain)], apply(rain[,GLOBAL.allnumericStart:ncol(rain)],1, sd) > 1)#
ncol(rain)#
ncol(rain.2)#
head(rain.2)
head(rain.2[,1:4])
ncol(rain)
ncol(rain.2)
subset(rain[,GLOBAL.allnumericStart:ncol(rain)], apply(rain[,GLOBAL.allnumericStart:ncol(rain)],1, sd) < 1)
par(mfrow = c(1,2))#
par(cex = 1.5)#
plot(ecdf(apply(rain[,GLOBAL.allnumericStart:ncol(rain)],2, sd)), col = "darkblue", verticals = TRUE, do.points = FALSE, lwd = 2, main = ncol(rain), xlab = "sd CT' ")    #
histSpike(apply(rain[,GLOBAL.allnumericStart:ncol(rain)],2, sd), add=TRUE, col = "darkred", frac = 0.2, lwd = 3)#
#
plot(ecdf(apply(rain.2[,GLOBAL.allnumericStart:ncol(rain.2)],2, sd)), col = "darkblue", verticals = TRUE, do.points = FALSE, lwd = 2, main = ncol(rain.2), xlab = "CT' ")    #
histSpike(apply(rain.2[,GLOBAL.allnumericStart:ncol(rain.2)],2, sd), add=TRUE, col = "darkred", frac = 0.2, lwd = 3)
rain <- rain.2#
GLOBAL.allnumericStart <- 1
colnames(rain)#
rownames(rain)#
GLOBAL.allnumericStart#
head(rain[,1:5])
rainCluster	<- melt(rain)#
rainCluster <- na.omit(rainCluster)#
rainCluster <- drop.levels(rainCluster)#
colnames(rainCluster) <- c("Primer","dCT")#
summary(rainCluster)#
nrow(rainCluster)#
head(rainCluster)#
IQR(rainCluster$dCT, na.rm = TRUE)#
fivenum(rainCluster$dCT, na.rm = TRUE)#
shapiro.test(rainCluster$dCT)#
png(file = "qqPlot Of All dCT.png", units = "in", width = 8, height = 8, res = 300)#
{#
par(mfrow = c(1,1))#
par(cex = 1.8)#
par(bty = "o")#
qqnorm(rainCluster[,"dCT"], #
pch = 19,#
cex = 0.5, #
las = 1,#
col = "darkred",#
main = "Samples")#
qqline(rainCluster[,"dCT"], col = "darkblue", lwd = 2, lty = 3)#
histSpike(rainCluster[,"dCT"], add=TRUE, col = "darkgray", frac = 0.5, lwd = 5, side =2)#
#
abline(h = 0, lty =2, col = "lightgray")#
abline(v = 0, lty =2, col = "lightgray")#
}#
dev.off()#
summary(rain[,1:4])#
GLOBAL.allnumericStart#
rownames(rain)#
colnames(rain)#
rain[,53:55]#
rain <- rain[,-c(53:55)]#
rownames(rain)#
try2m <- as.matrix(rain[,GLOBAL.allnumericStart:ncol(rain)]) #
nrow(try2m)#
nrow(try2m[!complete.cases(try2m),])#
rownames(try2m)#
head(try2m[,1:5])#
nrow(try2m)
rgb.palette <- colorRampPalette(c("white", "orange", "red"), space = "rgb", bias = 1)#
heatmap.plus(try2m, na.rm = T, scale = "none", col = rgb.palette(25), hclustfun=function(m) hclust(m, method="ward.D"), distfun = function(x) dist(x, method = "manhattan"), margins = c(10,15), Colv = T, Rowv = T)
png(file = "heatmap dCT' orange.png", units = "in", width = 21, height = 7, res = 300)#
{#
rgb.palette <- colorRampPalette(c("white", "orange", "red"), space = "rgb", bias = 1)#
heatmap.plus(try2m, na.rm = T, scale = "none", col = rgb.palette(25), hclustfun=function(m) hclust(m, method="ward.D"), distfun = function(x) dist(x, method = "manhattan"), margins = c(10,15), Colv = T, Rowv = T)#
}#
dev.off()#
png(file = "heatmap dCT' alternativeColor.png", units = "in", width = 21, height = 7, res = 300)#
{#
brewer.palette <- colorRampPalette(rev(brewer.pal(11, "RdYlBu")),space = "rgb", bias = 1.2, interpolate = "linear")#
heatmap.plus(try2m, na.rm = T, scale = "none", col = brewer.palette (55), hclustfun=function(m) hclust(m, method="ward.D"), distfun = function(x) dist(x, method = "manhattan"), margins = c(10,15), Colv = T, Rowv = T, main = "dCT", xlab = "CDS", ylab = "samples")#
}#
dev.off()#
png(file = "heatmap dCT'alternativeColor scaled by sample.png", units = "in", width = 21, height = 7, res = 300)#
{#
brewer.palette <- colorRampPalette(rev(brewer.pal(11, "RdYlBu")),space = "rgb", bias = 1, interpolate = "linear")#
heatmap.plus(try2m, na.rm = T, scale = "row", col = brewer.palette (55), #
hclustfun=function(m) hclust(m, method="ward.D"), #
distfun = function(x) dist(x, method = "manhattan"), #
margins = c(12,24), #
Colv = T, Rowv = T, #
cexRow = 1, cexCol = 0.5,#
main = "dCT' scaled by sample", xlab = "CDS", ylab = "samples")#
}#
dev.off()#
GLOBAL.tryDCT <- try2m#
summary(GLOBAL.tryDCT)#
head(GLOBAL.tryDCT)#
experimentByprimer <- try2m#
head(experimentByprimer)#
experimentByprimer  <- scale(experimentByprimer , center = TRUE, scale = FALSE)#
head(experimentByprimer)#
#
primer.cor <- cor(experimentByprimer, use="complete.obs",method="pearson")#
head(primer.cor)#
cor.plot(primer.cor, main = "all genes", zlim = c(0.5,1), cex.axis = 0.8, n = 12)#
primer.cor <- mat.sort(primer.cor)#
head(primer.cor)#
cor.plot(primer.cor, main = "dCT", zlim = c(-1,1), cex.axis = 0.8, n = 12)#
head(experimentByprimer[,1:4])#
png(file = "heatmap dCT' centered By Primer.png", units = "in", width = 21, height = 7, res = 300)#
{#
brewer.palette <- colorRampPalette(rev(brewer.pal(11, "RdYlBu")),space = "rgb", bias = 0.8, interpolate = "linear")#
heatmap.plus(experimentByprimer, na.rm = T, scale = "none", col = brewer.palette (55),#
hclustfun=function(m) hclust(m, method="ward.D"), #
distfun = function(x) dist(x, method = "manhattan"), #
margins = c(12,24), #
Colv = T, Rowv = T, #
cexRow = 1, cexCol = 0.5,#
main = "dCT' centered by primer", xlab = "primer", ylab = "samples")#
}#
dev.off()#
head(experimentByprimer)#
png(file = "heatmap dCT' centered By Primer purple.png", units = "in", width = 21, height = 7, res = 300)#
{#
brewer.palette <- colorRampPalette(rev(brewer.pal(11, "PuOr")),space = "rgb", bias = 0.8, interpolate = "spline")#
heatmap.plus(experimentByprimer, na.rm = T, scale = "none", col = brewer.palette (55),#
hclustfun=function(m) hclust(m, method="ward.D"), #
distfun = function(x) dist(x, method = "manhattan"), #
margins = c(12,24), #
Colv = T, Rowv = T, #
cexRow = 1, cexCol = 0.5,#
main = "dCT centered by primer", xlab = "primer", ylab = "samples")#
}#
dev.off()#
head(try2m)#
for.pca <- t(try2m)#
for.pca <- unique(for.pca)#
colnames(for.pca) <- rownames(try2m)#
rownames(for.pca) <- colnames(try2m)#
head(for.pca)#
#
mir.pca <- PCA(for.pca, scale.unit = T, ncp = 5, graph = F)#
par(mfrow = c(2,2))#
plot.PCA(mir.pca, cex=1.0, choix ="ind", axes = c(1,2), title = "Samples", col.ind = "darkred")#
plot.PCA(mir.pca, cex=1.0, choix ="ind", axes = c(2,3), title = "Samples", col.ind = "darkred")#
plot.PCA(mir.pca, cex=1.0, choix ="ind", axes = c(1,3), title = "Samples", col.ind = "darkred")#
#
dimdesc(mir.pca)#
barplot(mir.pca$eig[,1], main = "Eigenvalues", names.arg = paste ("Dim", 1:nrow(mir.pca$eig), sep = ""))
mir.hcpc <- HCPC(mir.pca)#
mir.hcpc$desc.var #
mir.hcpc$desc.axe#
mir.hcpc$desc.ind
head(try2m)#
for.pca <- try2m#
for.pca <- unique(for.pca)#
head(for.pca)#
#
mir.pca <- PCA(for.pca, scale.unit = F, ncp = Inf, graph = F)
par(mfrow = c(2,2))#
par(cex = 1.2)#
plot.PCA(mir.pca, cex=0.5, choix ="ind", axes = c(1,2), title = "Samples", col.ind = "darkblue")#
plot.PCA(mir.pca, cex=0.5, choix ="ind", axes = c(2,3), title = "Samples", col.ind = "darkblue")#
plot.PCA(mir.pca, cex=0.5, choix ="ind", axes = c(1,3), title = "Samples", col.ind = "darkblue")#
dimdesc(mir.pca)#
barplot(mir.pca$eig[,1], main = "Eigenvalues", names.arg = paste ("Dim", 1:nrow(mir.pca$eig), sep = ""), col = "darkgray", las = 2, cex.names = 0.5)
png(file = "PCA of samples.png", units = "in", width = 8, height = 8, res = 300)#
{#
par(mfrow = c(2,2))#
par(cex = 1.2)#
plot.PCA(mir.pca, cex=0.5, choix ="ind", axes = c(1,2), title = "Samples", col.ind = "darkblue")#
plot.PCA(mir.pca, cex=0.5, choix ="ind", axes = c(2,3), title = "Samples", col.ind = "darkblue")#
plot.PCA(mir.pca, cex=0.5, choix ="ind", axes = c(1,3), title = "Samples", col.ind = "darkblue")#
dimdesc(mir.pca)#
barplot(mir.pca$eig[,1], main = "Eigenvalues", names.arg = paste ("Dim", 1:nrow(mir.pca$eig), sep = ""), col = "darkgray", las = 2, cex.names = 0.5)#
}#
dev.off()#
#
mir.hcpc <- HCPC(mir.pca)#
mir.hcpc$desc.var #
mir.hcpc$desc.axe#
print(mir.hcpc$desc.ind)
head(GLOBAL.tryDCT)#
#
waterfall <- t(GLOBAL.tryDCT)#
waterfall <- data.frame(waterfall)#
head(waterfall)#
control <- waterfall[,"X8239"] #
waterfall <- sweep(waterfall,1,control,FUN = "-")#
waterfall <- waterfall[order(waterfall[,1], decreasing = F),]#
#
colnames(waterfall)#
par(mfrow = c(1,1))#
par(cex=1.0)#
par(bty="n")#
barplot(1.8^waterfall[,1], #
main = "K1 deletion", #
pch = 19, #
col = "gray", #
#
names.arg = rownames(waterfall), #
ylab = "fold induction", #
xaxs = "r",yaxs = "r", #
xaxt ="s",#
las = 3,#
#
ylim = c(0,5)#
)#
abline(h = median(waterfall[,1]), lwd = 1, col = "gray", lty = 2)#
abline(h = (median(waterfall[,1])-sd(waterfall[,1])), lwd = 1, col = "gray", lty = 2)#
abline(h = (median(waterfall[,1])+sd(waterfall[,1])), lwd = 1, col = "gray", lty = 2)#
head(waterfall)#
tail(waterfall)#
write.table(waterfall,file = "dCTordered.txt", sep = "\t")
